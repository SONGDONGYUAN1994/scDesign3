Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity...
y of x.y.z version should be even in release
Checking R version dependency...
Update R version dependency from 4.3.0 to 4.5.0
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews... OK
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R...
No 'fnd' role found in Authors@R. If the work is supported
        by a grant, consider adding the 'fnd' role to the list of authors.
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders...
Remove 'scDesign3.BiocCheck' from the package directory
Checking for inst/doc folders... OK
Checking vignette directory... OK
Checking package installation calls in R code... OK
Checking for library/require of scDesign3... OK
Checking coding practice...
 Avoid sapply(); use vapply()
Found in files:
R/construct_data.R (line 195, column 26)
R/construct_data.R (line 196, column 27)
R/extract_para.R (line 285, column 15)
R/extract_para.R (line 287, column 16)
R/extract_para.R (line 289, column 15)
R/fit_copula.R (line 116, column 25)
R/fit_copula.R (line 117, column 25)
R/fit_copula.R (line 334, column 23)
R/fit_copula.R (line 336, column 25)
R/fit_copula.R (line 338, column 23)
R/fit_copula.R (line 340, column 25)
R/fit_marginal.R (line 147, column 32)
R/fit_marginal.R (line 158, column 32)
R/fit_marginal.R (line 180, column 32)
R/fit_marginal.R (line 191, column 32)
R/fit_marginal.R (line 231, column 27)
R/fit_marginal.R (line 259, column 27)
R/gamlss_fix.R (line 488, column 33)
R/gamlss_fix.R (line 490, column 7)
R/gamlss_fix.R (line 492, column 7)
R/gamlss_fix.R (line 494, column 14)
R/gamlss_fix.R (line 500, column 14)
R/plot_reduceddim.R (line 55, column 23)
 Avoid 1:...; use seq_len() or seq_along()
Found in files:
fit_copula.R (line 643, column 13)
fit_copula.R (line 856, column 13)
fit_marginal.R (line 655, column 14)
simu_new.R (line 243, column 40)
sparse_cov.R (line 205, column 12)
sparse_cov.R (line 208, column 14)
 Avoid 'cat' and 'print' outside of 'show' methods
Found in files:
print() in R/fit_copula.R (line 294, column 11)
 Avoid using '=' for assignment and use '<-' instead
Found in files:
R/extract_para.R (line 152, column 19)
R/extract_para.R (line 215, column 21)
R/fit_copula.R (line 870, column 16)
R/fit_copula.R (line 895, column 16)
R/fit_marginal.R (line 125, column 18)
R/fit_marginal.R (line 137, column 15)
R/fit_marginal.R (line 139, column 15)
R/fit_marginal.R (line 269, column 25)
R/fit_marginal.R (line 302, column 24)
R/fit_marginal.R (line 310, column 22)
R/fit_marginal.R (line 311, column 18)
R/fit_marginal.R (line 343, column 24)
R/fit_marginal.R (line 350, column 22)
R/fit_marginal.R (line 351, column 18)
R/fit_marginal.R (line 382, column 24)
R/fit_marginal.R (line 390, column 22)
R/fit_marginal.R (line 391, column 18)
R/fit_marginal.R (line 423, column 24)
R/fit_marginal.R (line 431, column 22)
R/fit_marginal.R (line 432, column 18)
R/fit_marginal.R (line 461, column 22)
R/fit_marginal.R (line 470, column 20)
R/fit_marginal.R (line 471, column 16)
R/fit_marginal.R (line 498, column 22)
R/fit_marginal.R (line 507, column 20)
R/fit_marginal.R (line 508, column 16)
R/fit_marginal.R (line 530, column 18)
R/fit_marginal.R (line 532, column 18)
R/fit_marginal.R (line 730, column 8)
R/fit_marginal.R (line 733, column 16)
R/fit_marginal.R (line 734, column 20)
R/fit_marginal.R (line 735, column 14)
R/fit_marginal.R (line 736, column 12)
R/fit_marginal.R (line 737, column 24)
R/fit_marginal.R (line 738, column 14)
R/fit_marginal.R (line 739, column 20)
R/fit_marginal.R (line 740, column 11)
R/fit_marginal.R (line 751, column 33)
R/fit_marginal.R (line 752, column 35)
R/fit_marginal.R (line 754, column 36)
R/fit_marginal.R (line 755, column 38)
R/fit_marginal.R (line 757, column 39)
R/fit_marginal.R (line 758, column 41)
R/fit_marginal.R (line 760, column 36)
R/fit_marginal.R (line 761, column 38)
R/gamlss_fix.R (line 150, column 14)
R/gamlss_fix.R (line 152, column 5)
R/gamlss_fix.R (line 433, column 13)
R/gamlss_fix.R (line 514, column 13)
R/sparse_cov.R (line 144, column 12)
 Avoid the use of 'paste' in condition signals
Found in files:
R/fit_copula.R (line 161, column 15)
R/fit_copula.R (line 249, column 17)
R/fit_marginal.R (line 525, column 17)
R/fit_marginal.R (line 560, column 17)
R/perform_lrt.R (line 73, column 12)
R/perform_lrt.R (line 80, column 12)
R/simu_new.R (line 156, column 19)
Avoid redundant 'stop' and 'warn*' in signal conditions
Found in files:
R/fit_marginal.R (line 525, column 30)
 Avoid class membership checks with class() / is() and == / !=; Use is(x, 'class') for S4 classes
Found in files:
fit_copula.R (line 630, column 26)
fit_copula.R (line 842, column 26)
fit_marginal.R (line 596, column 28)
fit_marginal.R (line 624, column 28)
fit_marginal.R (line 680, column 28)
Checking parsed R code in R directory, examples, vignettes...
Avoid '<<-' if possible (found 1 times)
<<- in R/fit_marginal.R (line 218, column 12)
Avoid 'suppressWarnings'/'*Messages' if possible (found 8 times)
suppressMessages() in R/extract_para.R (line 279, column 12)
suppressMessages() in R/extract_para.R (line 281, column 12)
suppressMessages() in R/fit_marginal.R (line 599, column 20)
suppressMessages() in R/fit_marginal.R (line 609, column 21)
suppressMessages() in R/fit_marginal.R (line 628, column 29)
suppressMessages() in R/fit_marginal.R (line 640, column 30)
suppressMessages() in R/fit_marginal.R (line 683, column 33)
suppressMessages() in R/fit_marginal.R (line 694, column 34)
Checking function lengths...
The recommended function length is 50 lines or less. There are 21 functions greater than 50 lines.
The longest 5 functions are:
fit_marginal() (R/fit_marginal.R): 675 lines
fit_model_func() (R/fit_marginal.R): 469 lines
fit_copula() (R/fit_copula.R): 287 lines
simu_new() (R/simu_new.R): 276 lines
predict.gamlss() (R/gamlss_fix.R): 258 lines
Checking man page documentation...
Consider adding runnable examples to man pages that document exported objects.
plot_reduceddim.Rd
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 428 lines (10%) are > 80 characters long.
First few lines:
R/construct_data.R#L7 #' (explanatory variables) and the expre ...
R/construct_data.R#L10 #' @param assay_use A string which indic ...
R/construct_data.R#L11 #' @param celltype A string of the name  ...
R/construct_data.R#L12 #' @param pseudotime A string or a strin ...
R/construct_data.R#L14 #' @param spatial A length two string ve ...
R/construct_data.R#L15 #' @param other_covariates A string or a ...
R/construct_data.R#L16 #' @param ncell The number of cell you w ...
R/construct_data.R#L17 #' If an arbitrary number is provided, t ...
R/construct_data.R#L18 #' @param corr_by A string or a string v ...
R/construct_data.R#L19 #' @param parallelization A string indic ...
R/construct_data.R#L20 #' Must be one of 'mcmapply', 'bpmapply' ...
R/construct_data.R#L21 #' \code{parallel},\code{BiocParallel},  ...
R/construct_data.R#L22 #' @param BPPARAM A \code{MulticoreParam ...
R/construct_data.R#L23 #' this parameter must be NULL. When the ...
R/construct_data.R#L24 #' \code{MulticoreParam} object offered  ...
R/construct_data.R#L30 #'   \item{\code{newCovariate}}{The simu ...
R/construct_data.R#L31 #'   \item{\code{filtered_gene}}{The gen ...
R/construct_data.R#L61     stop("Please make sure your inputted ...
R/construct_data.R#L64     stop("Please make sure your inputted ...
R/construct_data.R#L106   #   stop("Covairate_use must be one of ...
R/construct_data.R#L126     newCovariate <- as.data.frame(simuCo ...
R/construct_data.R#L149       corr_group2 <- mclust::predict.Mcl ...
R/construct_data.R#L182   return(list(count_mat = count_mat, dat ...
R/construct_data.R#L203     df_all <-  dplyr::mutate(df, discret ...
R/construct_data.R#L240         new_dat_list <- paraFunc(FUN = d ...
R/construct_data.R#L242         new_dat_list <- paraFunc(FUN = d ...
R/construct_data.R#L257         new_dat_list <- paraFunc(FUN = d ...
R/construct_data.R#L259         new_dat_list <- paraFunc(FUN = d ...
R/extract_para.R#L3 #' \code{extract_para} generates paramet ...
R/extract_para.R#L5 #' The function takes the new covariate  ...
R/extract_para.R#L9 #' @param assay_use A string which indic ...
R/extract_para.R#L10 #' @param marginal_list A list of fitted ...
R/extract_para.R#L13 #' Must be one of 'poisson', 'nb', 'zip' ...
R/extract_para.R#L14 #' 'negative binomial distribution', 'ze ...
R/extract_para.R#L16 #' @param new_covariate A data.frame whi ...
R/extract_para.R#L18 #' @param parallelization A string indic ...
R/extract_para.R#L19 #' Must be one of 'mcmapply', 'bpmapply' ...
R/extract_para.R#L20 #' \code{parallel},\code{BiocParallel},  ...
R/extract_para.R#L21 #' @param BPPARAM A \code{MulticoreParam ...
R/extract_para.R#L22 #' this parameter must be NULL. When the ...
R/extract_para.R#L23 #' \code{MulticoreParam} object offered  ...
R/extract_para.R#L28 #'   \item{\code{sigma_mat}}{A cell by f ...
R/extract_para.R#L29 #'   \item{\code{zero_mat}}{A cell by fe ...
R/extract_para.R#L155                                    newda ...
R/extract_para.R#L182         stop("Distribution of gamlss mus ...
R/extract_para.R#L196           theta_vec <- rep(sqrt(fit$sig2 ...
R/extract_para.R#L201           stop("Distribution of gamlss m ...
R/extract_para.R#L218                                      new ...
R/extract_para.R#L223           stop("Distribution of gam must ...
R/extract_para.R#L279     mat <- suppressMessages(paraFunc(mat ...
R/extract_para.R#L281     mat <- suppressMessages(paraFunc(mat ...
R/extract_para.R#L295     zeros <- matrix(0, nrow = dim(mean_m ...
R/extract_para.R#L296     na_mat <- matrix(NA, nrow = dim(mean ...
R/fit_copula.R#L5 #' This function takes the result from \ ...
R/fit_copula.R#L11 #' @param input_data The input data, whi ...
R/fit_copula.R#L12 #' @param empirical_quantile Please only ...
R/fit_copula.R#L13 #' @param marginal_list A list of fitted ...
R/fit_copula.R#L14 #' @param family_use A string or a vecto ...
R/fit_copula.R#L15 #' @param copula A string of the copula  ...
R/fit_copula.R#L16 #' @param DT A logic variable. If TRUE,  ...
R/fit_copula.R#L17 #' to make the discrete data 'continuous ...
R/fit_copula.R#L18 #' Default is TRUE. Note that for contin ...
R/fit_copula.R#L19 #' @param pseudo_obs A logic variable. I ...
R/fit_copula.R#L21 #' @param epsilon A numeric variable for ...
R/fit_copula.R#L22 #' @param family_set A string or a strin ...
R/fit_copula.R#L23 #' @param important_feature A numeric va ...
R/fit_copula.R#L24 #' gene with zero proportion greater tha ...
R/fit_copula.R#L25 #' be a logical vector with length equal ...
R/fit_copula.R#L26 #' gene-gene correlation estimation and  ...
R/fit_copula.R#L28 #' @param if_sparse A logic variable. On ...
R/fit_copula.R#L30 #' @param correlation_function A string. ...
R/fit_copula.R#L31 #' @param parallelization A string indic ...
R/fit_copula.R#L32 #' Must be one of 'mcmapply', 'bpmapply' ...
R/fit_copula.R#L33 #' \code{parallel},\code{BiocParallel},  ...
R/fit_copula.R#L34 #' @param BPPARAM A \code{MulticoreParam ...
R/fit_copula.R#L35 #' this parameter must be NULL. When the ...
R/fit_copula.R#L36 #' \code{MulticoreParam} object offered  ...
R/fit_copula.R#L40 #'   \item{\code{new_mvu}}{A matrix of t ...
R/fit_copula.R#L41 #'   \item{\code{copula_list}}{A list of ...
R/fit_copula.R#L98       message("Use the empirical quantil ...
R/fit_copula.R#L138         stop("The important_feature shou ...
R/fit_copula.R#L143         gene_zero_prop <- apply(as.matri ...
R/fit_copula.R#L146         important_feature <- gene_zero_p ...
R/fit_copula.R#L149         stop("The important_feature shou ...
R/fit_copula.R#L219         stop("The important_feature shou ...
R/fit_copula.R#L224         gene_zero_prop <- apply(as.matri ...
R/fit_copula.R#L227         important_feature <- gene_zero_p ...
R/fit_copula.R#L230         stop("The important_feature shou ...
R/fit_copula.R#L368 ## Calculate the correlation matrix. If  ...
R/fit_copula.R#L391       important_cor.mat <- correlation(i ...
R/fit_copula.R#L399     cor.mat[rownames(important_cor.mat), ...
R/fit_copula.R#L426   cor.mat <- methods::as(methods::as(met ...
R/fit_copula.R#L459       mean_vec <- stats::predict(fit, ty ...
R/fit_copula.R#L464           stats::predict(fit, type = "re ...
R/fit_copula.R#L467           1 / stats::predict(fit, type = ...
R/fit_copula.R#L474         theta_vec <- stats::predict(fit, ...
R/fit_copula.R#L478         stop("Distribution of gamlss mus ...
R/fit_copula.R#L482       ## Check the family (since sometim ...
R/fit_copula.R#L493         theta_vec <- rep(sqrt(fit$sig2), ...
R/fit_copula.R#L542       stop("Distribution of gamlss must  ...
R/fit_copula.R#L561           stats::pnbinom(x[1] - 1, mu =  ...
R/fit_copula.R#L565           ifelse(x[1] > 0, gamlss.dist:: ...
R/fit_copula.R#L579         stop("Distribution of gamlss mus ...
R/fit_copula.R#L633     mat <- paraFunc(mat_function, x = se ...
R/fit_copula.R#L635     mat <- paraFunc(mat_function, x = se ...
R/fit_copula.R#L679       mean_vec <- stats::predict(fit, ty ...
R/fit_copula.R#L684           stats::predict(fit, type = "re ...
R/fit_copula.R#L687           1 / stats::predict(fit, type = ...
R/fit_copula.R#L694         theta_vec <- stats::predict(fit, ...
R/fit_copula.R#L698         stop("Distribution of gamlss mus ...
R/fit_copula.R#L711         theta_vec <- rep(sqrt(fit$sig2), ...
R/fit_copula.R#L716         stop("Distribution of mgcv must  ...
R/fit_copula.R#L761       stop("Distribution of gamlss must  ...
R/fit_copula.R#L779           stats::pnbinom(x[1] - 1, mu =  ...
R/fit_copula.R#L783           ifelse(x[1] > 0, gamlss.dist:: ...
R/fit_copula.R#L797         stop("Distribution of gamlss mus ...
R/fit_copula.R#L845     mat <- paraFunc(mat_function, x = se ...
R/fit_copula.R#L847     mat <- paraFunc(mat_function, x = se ...
R/fit_copula.R#L908       ) - sum(rowSums(stats::dnorm(norm. ...
R/fit_copula.R#L914 ## Similar to the cora function from "Rf ...
R/fit_copula.R#L929 ## Similar to the cova function from "Rf ...
R/fit_copula.R#L950     CH <- Matrix::Cholesky(methods::as(m ...
R/fit_copula.R#L957         rmvnorm(n, mean = rep(0, p), sig ...
R/fit_copula.R#L966 ## fix integer overflow issue when # of  ...
R/fit_copula.R#L969                     method=c("eigen", "s ...
R/fit_copula.R#L1001   retval <- matrix(stats::rnorm(as.doubl ...
R/fit_marginal.R#L9 #' @param predictor A string of the pred ...
R/fit_marginal.R#L10 #' @param mu_formula A string of the mu  ...
R/fit_marginal.R#L12 #' @param family_use A string or a vecto ...
R/fit_marginal.R#L13 #' Must be one of 'binomial', 'poisson', ...
R/fit_marginal.R#L14 #' 'negative binomial distribution', 'ze ...
R/fit_marginal.R#L17 #' @param usebam A logic variable. If us ...
R/fit_marginal.R#L18 #' @param edf_flexible A logic variable. ...
R/fit_marginal.R#L19 #' @param parallelization A string indic ...
R/fit_marginal.R#L20 #' Must be one of 'mcmapply', 'bpmapply' ...
R/fit_marginal.R#L21 #' \code{parallel},\code{BiocParallel},  ...
R/fit_marginal.R#L22 #' @param BPPARAM A \code{MulticoreParam ...
R/fit_marginal.R#L23 #' this parameter must be NULL. When the ...
R/fit_marginal.R#L24 #' \code{MulticoreParam} object offered  ...
R/fit_marginal.R#L25 #' @param trace A logic variable. If TRU ...
R/fit_marginal.R#L27 #' @param simplify A logic variable. If  ...
R/fit_marginal.R#L28 #' @param filter_cells A logic variable. ...
R/fit_marginal.R#L29 #' @return A list of fitted regression m ...
R/fit_marginal.R#L103       edf_flexible_family_use <- rep(fam ...
R/fit_marginal.R#L108     stop("The family_use must be either  ...
R/fit_marginal.R#L135     usebam <- usebam & mu_mgcvform ## If ...
R/fit_marginal.R#L147         terms_smooth_update <- sapply(te ...
R/fit_marginal.R#L150             stats::formula(paste0(predic ...
R/fit_marginal.R#L155             stats::formula(paste0(predic ...
R/fit_marginal.R#L158         terms_smooth_update <- sapply(te ...
R/fit_marginal.R#L161             stats::formula(paste0(predic ...
R/fit_marginal.R#L166             stats::formula(paste0(predic ...
R/fit_marginal.R#L174     sigma_mgcvform <- grepl("s\\(", sigm ...
R/fit_marginal.R#L176       temp_sigma_formula <- stats::formu ...
R/fit_marginal.R#L180         terms_smooth_update <- sapply(te ...
R/fit_marginal.R#L183             stats::formula(paste0("~", p ...
R/fit_marginal.R#L191         terms_smooth_update <- sapply(te ...
R/fit_marginal.R#L194             stats::formula(paste0("~", p ...
R/fit_marginal.R#L224       add_log("fit_marginal","warning",  ...
R/fit_marginal.R#L243             return(list(idx = which(dat_ ...
R/fit_marginal.R#L263           mgcv_formula <- stats::update. ...
R/fit_marginal.R#L264           mu_formula <- stats::update.fo ...
R/fit_marginal.R#L269           sigma_formula = stats::update. ...
R/fit_marginal.R#L286           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L328           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L367           res <- fitfunc(formula = mgcv_ ...
R/fit_marginal.R#L408           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L448           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L464             sigma.formula = mu_formula,  ...
R/fit_marginal.R#L485           res <- fitfunc(formula = mgcv_ ...
R/fit_marginal.R#L519       stop("The regression distribution  ...
R/fit_marginal.R#L540       mean_vec <- stats::predict(gamlss. ...
R/fit_marginal.R#L542         stats::predict(gamlss.fit, type  ...
R/fit_marginal.R#L545       if_overmax <- (max(mean_vec, na.rm ...
R/fit_marginal.R#L556         add_log("fit_marginal","warning" ...
R/fit_marginal.R#L576       return(list(fit = fit, warning = l ...
R/fit_marginal.R#L599       model_fit <- suppressMessages(para ...
R/fit_marginal.R#L602                                          ...
R/fit_marginal.R#L603                                          ...
R/fit_marginal.R#L604                                          ...
R/fit_marginal.R#L605                                          ...
R/fit_marginal.R#L606                                          ...
R/fit_marginal.R#L607                                          ...
R/fit_marginal.R#L609       model_fit <-  suppressMessages(par ...
R/fit_marginal.R#L613                                          ...
R/fit_marginal.R#L614                                          ...
R/fit_marginal.R#L615                                          ...
R/fit_marginal.R#L616                                          ...
R/fit_marginal.R#L617                                          ...
R/fit_marginal.R#L628       model_fit_edf_gini <- suppressMess ...
R/fit_marginal.R#L629                                          ...
R/fit_marginal.R#L630                                          ...
R/fit_marginal.R#L631                                          ...
R/fit_marginal.R#L632                                          ...
R/fit_marginal.R#L633                                          ...
R/fit_marginal.R#L634                                          ...
R/fit_marginal.R#L635                                          ...
R/fit_marginal.R#L636                                          ...
R/fit_marginal.R#L640       model_fit_edf_gini <-  suppressMes ...
R/fit_marginal.R#L641                                          ...
R/fit_marginal.R#L643                                          ...
R/fit_marginal.R#L644                                          ...
R/fit_marginal.R#L645                                          ...
R/fit_marginal.R#L646                                          ...
R/fit_marginal.R#L647                                          ...
R/fit_marginal.R#L648                                          ...
R/fit_marginal.R#L672     edf_flexible_count_gini <- apply(log ...
R/fit_marginal.R#L674     edf_flexible_predicted <- stats::pre ...
R/fit_marginal.R#L683       model_fit_edf_flexible <- suppress ...
R/fit_marginal.R#L684                                          ...
R/fit_marginal.R#L685                                          ...
R/fit_marginal.R#L686                                          ...
R/fit_marginal.R#L687                                          ...
R/fit_marginal.R#L688                                          ...
R/fit_marginal.R#L689                                          ...
R/fit_marginal.R#L690                                          ...
R/fit_marginal.R#L691                                          ...
R/fit_marginal.R#L692                                          ...
R/fit_marginal.R#L694       model_fit_edf_flexible <-  suppres ...
R/fit_marginal.R#L695                                          ...
R/fit_marginal.R#L697                                          ...
R/fit_marginal.R#L698                                          ...
R/fit_marginal.R#L699                                          ...
R/fit_marginal.R#L700                                          ...
R/fit_marginal.R#L701                                          ...
R/fit_marginal.R#L702                                          ...
R/fit_marginal.R#L703                                          ...
R/fit_marginal.R#L729   ## This function is modified from http ...
R/gamlss_fix.R#L3 #' An additive function to be used while ...
R/gamlss_fix.R#L24   # get where "gamlss" is in system call ...
R/gamlss_fix.R#L42   ## function does not fail (It need to  ...
R/gamlss_fix.R#L103 #' An additive function to be used while ...
R/gamlss_fix.R#L120   # get where "gamlss" is in system call ...
R/gamlss_fix.R#L133   ## function does not fail (It need to  ...
R/gamlss_fix.R#L137     if (is.null(get("gamlsscall", envir= ...
R/gamlss_fix.R#L149   formula <- stats::as.formula(paste0("Y ...
R/gamlss_fix.R#L185   #    coef=NULL,drop.unused.levels=TRUE ...
R/gamlss_fix.R#L201 #' The control for \code{ba()}. From \co ...
R/gamlss_fix.R#L206 #' @param control A list of fit control  ...
R/gamlss_fix.R#L207 #' @param select The \code{select} argum ...
R/gamlss_fix.R#L208 #' @param scale For the scale parameter. ...
R/gamlss_fix.R#L209 #' @param gamma The \code{gamma} argumen ...
R/gamlss_fix.R#L210 #' @param knots The \code{knots} argumen ...
R/gamlss_fix.R#L211 #' @param sp The \code{sp} argument in \ ...
R/gamlss_fix.R#L212 #' @param min.sp The \code{min.sp} argum ...
R/gamlss_fix.R#L213 #' @param paraPen The \code{paraPen} arg ...
R/gamlss_fix.R#L214 #' @param chunk.size The model matrix is ...
R/gamlss_fix.R#L215 #' @param rho An AR1 error model can be  ...
R/gamlss_fix.R#L216 #' @param AR.start Logical variable of s ...
R/gamlss_fix.R#L217 #' @param discrete With \code{method="fR ...
R/gamlss_fix.R#L218 #' @param cluster \code{bam} can compute ...
R/gamlss_fix.R#L219 #' @param nthreads Number of threads to  ...
R/gamlss_fix.R#L220 #' @param gc.level To keep the memory fo ...
R/gamlss_fix.R#L221 #' @param use.chol By default \code{bam} ...
R/gamlss_fix.R#L222 #' @param samfrac For very large sample  ...
R/gamlss_fix.R#L224 #' @param drop.unused.levels By default  ...
R/gamlss_fix.R#L225 #' @param drop.intercept Set to \code{TR ...
R/gamlss_fix.R#L270 #' The control for \code{ga()}. From \co ...
R/gamlss_fix.R#L274 #' @param optimizer An array specifying  ...
R/gamlss_fix.R#L275 #' @param control A list of fit control  ...
R/gamlss_fix.R#L276 #' @param scale If this is positive then ...
R/gamlss_fix.R#L277 #' @param select If this is \code{TRUE}  ...
R/gamlss_fix.R#L278 #' @param knots This is an optional list ...
R/gamlss_fix.R#L281 #' @param H A user supplied fixed quadra ...
R/gamlss_fix.R#L283 #' @param paraPen Optional list specifyi ...
R/gamlss_fix.R#L285 #' @param drop.unused.levels By default  ...
R/gamlss_fix.R#L286 #' @param drop.intercept Set to \code{TR ...
R/gamlss_fix.R#L287 #' @param discrete Experimental option f ...
R/gamlss_fix.R#L316        paraPen=paraPen, in.out=in.out,   ...
R/gamlss_fix.R#L329 #' @param what For which parameter to ex ...
R/gamlss_fix.R#L335 model.frame.gamlss <- function(formula,  ...
R/gamlss_fix.R#L373 #'This is support for the  smoother func ...
R/gamlss_fix.R#L396     df <- sum(ifelse(is.null(fit$edf2),  ...
R/gamlss_fix.R#L406     SL <- get("smooth.labels", envir=gam ...
R/gamlss_fix.R#L407     fit <- eval(parse(text=paste("obj$", ...
R/gamlss_fix.R#L417 #'This is support for the  smoother func ...
R/gamlss_fix.R#L450     df <- sum(ifelse(is.null(fit$edf2),  ...
R/gamlss_fix.R#L460     SL <- get("smooth.labels", envir=gam ...
R/gamlss_fix.R#L461     fit <- eval(parse(text=paste("obj$", ...
R/gamlss_fix.R#L474                            type = c("lin ...
R/gamlss_fix.R#L481   ##------------------------------------ ...
R/gamlss_fix.R#L482   ##------------------------------------ ...
R/gamlss_fix.R#L507   ##------------------------------------ ...
R/gamlss_fix.R#L508   ##------------------------------------ ...
R/gamlss_fix.R#L515     #predictor<- lpred(object, what = wh ...
R/gamlss_fix.R#L521     warning(" se.fit = TRUE is not suppo ...
R/gamlss_fix.R#L523   ## note that atomic is not working her ...
R/gamlss_fix.R#L529     match.arg(parameter, choices=c("mu", ...
R/gamlss_fix.R#L550   parform <- stats::formula(object, what ...
R/gamlss_fix.R#L563   m <- stats::model.frame(Terms, data, x ...
R/gamlss_fix.R#L591   # if (abs(sum(resid(refit)))>1e-001||a ...
R/gamlss_fix.R#L592   #   warning(paste("There is a discrepa ...
R/gamlss_fix.R#L605   Xpred <- matrix(Xpred, nrow=nrows) # I ...
R/gamlss_fix.R#L636     #              Rinv <- qr.solve(qr.R ...
R/gamlss_fix.R#L678     smooth.labels <- dimnames(smo.mat)[[ ...
R/gamlss_fix.R#L680                                          ...
R/gamlss_fix.R#L687     attr(data, "class") <- NULL          ...
R/gamlss_fix.R#L690     residuals <-  if (!is.null(off.num)) ...
R/gamlss_fix.R#L694       if (is.matrix(m[[TT]])) # the prob ...
R/gamlss_fix.R#L695       { # MS 27-6-11         # in this c ...
R/gamlss_fix.R#L696         nm <- names(attributes(m[[TT]])) ...
R/gamlss_fix.R#L697         attributes(data[[TT]]) <- attrib ...
R/gamlss_fix.R#L722     FAM <- gamlss.dist::as.gamlss.family ...
R/perform_lrt.R#L3 #' \code{perform_lrt} performs the likel ...
R/perform_lrt.R#L5 #' The function takes two lists of margi ...
R/perform_lrt.R#L6 #' from \code{\link{fit_marginal}}. Note ...
R/perform_lrt.R#L8 #' @param alter_marginal A list of margi ...
R/perform_lrt.R#L9 #' @param null_marginal A list of margin ...
R/perform_lrt.R#L80       stop(paste("Models appear to have  ...
R/perform_lrt.R#L117     names(res) <- c("same_model", "LogLi ...
R/plot_reduceddim.R#L5 #' This function takes a reference sce a ...
R/plot_reduceddim.R#L11 #' @param name_vec A vector of the names ...
R/plot_reduceddim.R#L15 #' @param pc_umap A logic value of wheth ...
R/plot_reduceddim.R#L16 #' @param center A logic value of whethe ...
R/plot_reduceddim.R#L17 #' @param scale. A logic value of whethe ...
R/plot_reduceddim.R#L18 #' @param if_plot A logic value of wheth ...
R/plot_reduceddim.R#L19 #' @param shape_by A string which indica ...
R/plot_reduceddim.R#L20 #' @param color_by A string which indica ...
R/plot_reduceddim.R#L21 #' @param point_size A numeric value of  ...
R/plot_reduceddim.R#L53       stop("The shape_by in not in your  ...
R/plot_reduceddim.R#L55     shape_by_check <- sapply(sce_list, f ...
R/plot_reduceddim.R#L57       stop("The shape_by in not in your  ...
R/plot_reduceddim.R#L84     SingleCellExperiment::reducedDim(x,  ...
R/plot_reduceddim.R#L86       res <- stats::predict(object = ref ...
R/plot_reduceddim.R#L121     p_pca <- ggplot(rd_tbl, aes_string(x ...
R/plot_reduceddim.R#L126     p_umap <- ggplot(rd_tbl, aes_string( ...
R/plot_reduceddim.R#L136       p_pca <- p_pca + guides(color = gu ...
R/plot_reduceddim.R#L137       p_umap <- p_umap + guides(color =  ...
R/scdesign3.R#L6 #' @param assay_use A string which indic ...
R/scdesign3.R#L7 #' @param celltype A string of the name  ...
R/scdesign3.R#L8 #' @param pseudotime A string or a strin ...
R/scdesign3.R#L10 #' @param spatial A length two string ve ...
R/scdesign3.R#L11 #' @param other_covariates A string or a ...
R/scdesign3.R#L12 #' @param ncell The number of cell you w ...
R/scdesign3.R#L18 #' @param correlation_function A string. ...
R/scdesign3.R#L19 #' @param usebam A logic variable. If us ...
R/scdesign3.R#L20 #' @param edf_flexible A logic variable. ...
R/scdesign3.R#L22 #' @param empirical_quantile Please only ...
R/scdesign3.R#L23 #' @param copula A string of the copula  ...
R/scdesign3.R#L24 #' @param if_sparse A logic variable. On ...
R/scdesign3.R#L25 #' @param fastmvn An logical variable. I ...
R/scdesign3.R#L26 #' @param DT A logic variable. If TRUE,  ...
R/scdesign3.R#L27 #' to make the discrete data 'continuous ...
R/scdesign3.R#L28 #' Default is TRUE. Note that for contin ...
R/scdesign3.R#L29 #' @param pseudo_obs A logic variable. I ...
R/scdesign3.R#L31 #' @param family_set A string or a strin ...
R/scdesign3.R#L32 #' @param important_feature A numeric va ...
R/scdesign3.R#L33 #' gene with zero proportion greater tha ...
R/scdesign3.R#L34 #' be a logical vector with length equal ...
R/scdesign3.R#L35 #' gene-gene correlation estimation and  ...
R/scdesign3.R#L37 #' @param nonnegative A logical variable ...
R/scdesign3.R#L38 #' @param nonzerovar A logical variable. ...
R/scdesign3.R#L39 #' @param return_model A logic variable. ...
R/scdesign3.R#L40 #' @param simplify A logic variable. If  ...
R/scdesign3.R#L41 #' @param parallelization A string indic ...
R/scdesign3.R#L42 #' @param n_rep An integer number. The n ...
R/scdesign3.R#L43 #' Must be one of 'mcmapply', 'bpmapply' ...
R/scdesign3.R#L44 #' \code{parallel},\code{BiocParallel},  ...
R/scdesign3.R#L45 #' @param BPPARAM A \code{MulticoreParam ...
R/scdesign3.R#L46 #' this parameter must be NULL. When the ...
R/scdesign3.R#L47 #' \code{MulticoreParam} object offered  ...
R/scdesign3.R#L48 #' @param trace A logic variable. If TRU ...
R/scdesign3.R#L52 #'   \item{\code{new_count}}{A matrix of ...
R/scdesign3.R#L55 #'   \item{\code{marginal_list}}{A list  ...
R/scdesign3.R#L56 #'   \item{\code{corr_list}}{A list of c ...
R/simu_new.R#L3 #' \code{simu_new} generates new simulat ...
R/simu_new.R#L5 #' The function takes the new covariate  ...
R/simu_new.R#L6 #' parameter matrices from \code{\link{e ...
R/simu_new.R#L9 #' @param assay_use A string which indic ...
R/simu_new.R#L14 #' @param copula_list A list of copulas  ...
R/simu_new.R#L16 #' @param fastmvn An logical variable. I ...
R/simu_new.R#L19 #' @param nonnegative A logical variable ...
R/simu_new.R#L20 #' @param nonzerovar A logical variable. ...
R/simu_new.R#L22 #' @param new_covariate A data.frame whi ...
R/simu_new.R#L23 #' @param important_feature important_fe ...
R/simu_new.R#L24 #' this string must be either "all" (usi ...
R/simu_new.R#L25 #' for each gene. Gene with zero proport ...
R/simu_new.R#L26 #' be a logical vector with length equal ...
R/simu_new.R#L27 #' gene-gene correlation estimation and  ...
R/simu_new.R#L29 #' @param parallelization A string indic ...
R/simu_new.R#L30 #' Must be one of 'mcmapply', 'bpmapply' ...
R/simu_new.R#L31 #' \code{parallel},\code{BiocParallel},  ...
R/simu_new.R#L32 #' @param BPPARAM A \code{MulticoreParam ...
R/simu_new.R#L33 #' this parameter must be NULL. When the ...
R/simu_new.R#L34 #' \code{MulticoreParam} object offered  ...
R/simu_new.R#L35 #' @param filtered_gene A vector or NULL ...
R/simu_new.R#L36 #' steps because these genes only expres ...
R/simu_new.R#L37 #' @return A feature by cell matrix of t ...
R/simu_new.R#L130       newmvn_full[rownames(quantile_mat) ...
R/simu_new.R#L171             if (methods::is(cor.mat, "ma ...
R/simu_new.R#L176               corr_gene_idx <- apply(cor ...
R/simu_new.R#L180                                          ...
R/simu_new.R#L190                 new_mvn_non_important <- ...
R/simu_new.R#L191                 new_mvn_non_important_ma ...
R/simu_new.R#L229               stop("Copula must be one f ...
R/simu_new.R#L237         }, sce = sce, ind = ind, n_cores ...
R/simu_new.R#L255       para_mat <- cbind(mean_mat[idx, x] ...
R/simu_new.R#L258         qfvec <- stats::qbinom(p = para_ ...
R/simu_new.R#L276                             sigma = ifel ...
R/simu_new.R#L283                               nu = ifels ...
R/simu_new.R#L285         stop("Distribution of gamlss mus ...
R/simu_new.R#L328     mat <-  paraFunc(mat_function, x = s ...
R/simu_new.R#L330     mat <- paraFunc(mat_function, x = se ...
R/sparse_cov.R#L1 #' This function computes the thresholdi ...
R/sparse_cov.R#L51 ## This function computes the thresholdi ...
R/sparse_cov.R#L173 # The tuning parameter lambda was select ...
R/sparse_cov.R#L174 # difference between s(sample_cov(train) ...
R/sparse_cov.R#L210       testIndexes <- which(folds==i, arr ...
R/sparse_cov.R#L211       #trainIndexes <- which(folds!=i, a ...
R/sparse_cov.R#L216       s <- thresh_op(sample.cov.train, o ...
R/sparse_cov.R#L217       # Compute Frobenius risk = norm(di ...
R/sparse_cov.R#L250       testIndexes <- which(folds==i, arr ...
R/sparse_cov.R#L256       # Compute Frobenius risk = norm(di ...
vignettes/scDesign3.Rmd#L39     crop = NULL ## Related to https://st ...
vignettes/scDesign3.Rmd#L52 scDesign3 is a unified probabilistic fra ...
vignettes/scDesign3.Rmd#L56 The raw data is from the [scvelo](https: ...
vignettes/scDesign3.Rmd#L68 The function `scdesign3()` takes in a `S ...
vignettes/scDesign3.Rmd#L79     sigma_formula = "1", # If you want y ...
vignettes/scDesign3.Rmd#L95   + If the parameter `ncell` is set to a ...
vignettes/scDesign3.Rmd#L97 * `model_aic`: This is a vector include  ...
vignettes/scDesign3.Rmd#L98 * `model_bic`: This is a vector include  ...
vignettes/scDesign3.Rmd#L100   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L101   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L103   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L104   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L106 In this example, since we did not change ...
vignettes/scDesign3.Rmd#L110 Then, we can create the `SinglecellExper ...
vignettes/scDesign3.Rmd#L113 simu_sce <- SingleCellExperiment(list(co ...
Consider multiples of 4 spaces for line indents; 2038 lines (46%) are not.
First few lines:
R/construct_data.R#L49                            assay_use = " ...
R/construct_data.R#L50                            celltype, ...
R/construct_data.R#L51                            pseudotime, ...
R/construct_data.R#L52                            spatial, ...
R/construct_data.R#L53                            other_covaria ...
R/construct_data.R#L54                            ncell = dim(s ...
R/construct_data.R#L55                            corr_by, ...
R/construct_data.R#L56                            parallelizati ...
R/construct_data.R#L57                            BPPARAM = NUL ...
R/construct_data.R#L58    ...
R/construct_data.R#L59   ## check unique cell names and gene na ...
R/construct_data.R#L60   if(length(unique(colnames(sce))) != di ...
R/construct_data.R#L62   } ...
R/construct_data.R#L63   if(length(unique(rownames(sce))) != di ...
R/construct_data.R#L65   } ...
R/construct_data.R#L66   ## Extract expression matrix ...
R/construct_data.R#L67   count_mat <- ...
R/construct_data.R#L69   ## Extract col data ...
R/construct_data.R#L70   coldata_mat <- data.frame(SummarizedEx ...
R/construct_data.R#L71    ...
R/construct_data.R#L72   ## ...
R/construct_data.R#L73   if (is.null(celltype) & is.null(pseudo ...
R/construct_data.R#L75   } else { ...
R/construct_data.R#L78   } ...
R/construct_data.R#L79    ...
R/construct_data.R#L80   if(!is.null(celltype)) { ...
R/construct_data.R#L82    ...
R/construct_data.R#L83   # ## Extract pseudotime / cell type /  ...
R/construct_data.R#L84   # if (!is.null(celltype)) { ...
R/construct_data.R#L85   #   celltype <- as.matrix(coldata_mat[ ...
R/construct_data.R#L86   # } ...
R/construct_data.R#L87   # ...
R/construct_data.R#L88   # if (!is.null(pseudotime)) { ...
R/construct_data.R#L89   #   pseudotime <- as.matrix(coldata_ma ...
R/construct_data.R#L90   # } ...
R/construct_data.R#L91   # ...
R/construct_data.R#L92   # if (!is.null(spatial)) { ...
R/construct_data.R#L93   #   spatial <- as.matrix(coldata_mat[, ...
R/construct_data.R#L94   # } ...
R/construct_data.R#L95   # ...
R/construct_data.R#L96   # ...
R/construct_data.R#L97   # if (covariate_use == "celltype") { ...
R/construct_data.R#L98   #   dat <- data.frame(celltype) ...
R/construct_data.R#L99   #   dat$cell_type <- as.factor(dat$cel ...
R/construct_data.R#L100   # } else if (covariate_use == "pseudot ...
R/construct_data.R#L101   #   n_l <- dim(pseudotime)[2] ...
R/construct_data.R#L102   #   dat <- data.frame(pseudotime) ...
R/construct_data.R#L103   # } else if (covariate_use == "spatial ...
R/construct_data.R#L104   #   dat <- data.frame(spatial) ...
R/construct_data.R#L105   # } else { ...
R/construct_data.R#L106   #   stop("Covairate_use must be one of ...
R/construct_data.R#L107   # } ...
R/construct_data.R#L108    ...
R/construct_data.R#L109   ## Convert NA to -1 ...
R/construct_data.R#L110   #pseudotime[is.na(pseudotime)] <- -1 ...
R/construct_data.R#L111    ...
R/construct_data.R#L112   ## dat is the input covariate matrix ...
R/construct_data.R#L113   if (!is.null(other_covariates)) { ...
R/construct_data.R#L117       dat$condition <- as.factor(dat$con ...
R/construct_data.R#L120       dat$batch <- as.factor(dat$batch) ...
R/construct_data.R#L122   } ...
R/construct_data.R#L123    ...
R/construct_data.R#L124   ## check if user wants to simulate new ...
R/construct_data.R#L125   if(ncell != dim(dat)[1]){ ...
R/construct_data.R#L127   }else{ ...
R/construct_data.R#L129   } ...
R/construct_data.R#L130    ...
R/construct_data.R#L131   # identify groups ...
R/construct_data.R#L132   n_gene <- dim(sce)[1] ...
R/construct_data.R#L133   n_cell <- dim(sce)[2] ...
R/construct_data.R#L134   group <- unlist(corr_by) ...
R/construct_data.R#L135   if(ncell != dim(dat)[1]){ ...
R/construct_data.R#L137       corr_group <- rep(1, n_cell) ...
R/construct_data.R#L138       corr_group2 <- rep(1, dim(newCovar ...
R/construct_data.R#L140       corr_group <- rep("ind", n_cell) ...
R/construct_data.R#L141       corr_group2 <- rep("ind", dim(newC ...
R/construct_data.R#L143       ## For continuous pseudotime, disc ...
R/construct_data.R#L144       corr_group <- SummarizedExperiment ...
R/construct_data.R#L145       mclust_mod <- mclust::Mclust(corr_ ...
R/construct_data.R#L146       corr_group <- mclust_mod$classific ...
R/construct_data.R#L147        ...
R/construct_data.R#L148       corr_group2 <- newCovariate[, grou ...
R/construct_data.R#L149       corr_group2 <- mclust::predict.Mcl ...
R/construct_data.R#L150        ...
R/construct_data.R#L152       corr_group <- SummarizedExperiment ...
R/construct_data.R#L153       corr_group2 <- newCovariate[, grou ...
R/construct_data.R#L156   }else{ ...
R/construct_data.R#L158       corr_group <- rep(1, n_cell) ...
R/construct_data.R#L160       corr_group <- rep("ind", n_cell) ...
R/construct_data.R#L162       ## For continuous pseudotime, disc ...
R/construct_data.R#L163       corr_group <- SummarizedExperiment ...
R/construct_data.R#L164       mclust_mod <- mclust::Mclust(corr_ ...
R/construct_data.R#L165        ...
R/construct_data.R#L166       corr_group <- mclust_mod$classific ...
R/construct_data.R#L167        ...
R/construct_data.R#L169       corr_group <- SummarizedExperiment ...
R/construct_data.R#L171   } ...
R/construct_data.R#L172   dat$corr_group <- corr_group ...
R/construct_data.R#L173    ...
R/construct_data.R#L174   qc <- apply(count_mat, 2, function(x){ ...
R/construct_data.R#L176   }) ...
R/construct_data.R#L177   if(length(which(qc)) == 0){ ...
R/construct_data.R#L179   }else{ ...
R/construct_data.R#L181   } ...
R/construct_data.R#L182   return(list(count_mat = count_mat, dat ...
R/construct_data.R#L188                              n_cell_new  ...
R/construct_data.R#L189                              paralleliza ...
R/construct_data.R#L190                              BPPARAM = N ...
R/construct_data.R#L191    ...
R/construct_data.R#L192   n_cell_ori <- dim(covariate_mat)[1] ...
R/construct_data.R#L193   n_covraite_ori <- dim(covariate_mat)[2 ...
R/construct_data.R#L194    ...
R/construct_data.R#L195   if_factor_exist <- sum(sapply(covariat ...
R/construct_data.R#L196   if_numeric_exist <- sum(sapply(covaria ...
R/construct_data.R#L197    ...
R/construct_data.R#L198    ...
R/construct_data.R#L199    ...
R/construct_data.R#L200   df <- covariate_mat ...
R/construct_data.R#L201    ...
R/construct_data.R#L202   if(if_factor_exist) { ...
R/construct_data.R#L212       BPPARAM <- BiocParallel::SnowParam ...
R/construct_data.R#L213       parallelization <- "bpmapply" ...
R/construct_data.R#L216       paraFunc <- BiocParallel::bpmapply ...
R/construct_data.R#L219       paraFunc <- pbmcapply::pbmcmapply ...
R/construct_data.R#L223       dat_function <- {function(df, n) { ...
R/construct_data.R#L228           return(NA) ...
R/construct_data.R#L237       }} ...
R/construct_data.R#L238        ...
R/construct_data.R#L239       if(parallelization == "bpmapply"){ ...
R/construct_data.R#L241       }else{ ...
R/construct_data.R#L243       } ...
R/construct_data.R#L244       covariate_new <- do.call("rbind",  ...
R/construct_data.R#L247       dat_function <- function(df, n) { ...
R/construct_data.R#L255       } ...
R/construct_data.R#L256       if(parallelization == "bpmapply"){ ...
R/construct_data.R#L258       }else{ ...
R/construct_data.R#L260       } ...
R/construct_data.R#L261       covariate_new <- do.call("rbind",  ...
R/construct_data.R#L262        ...
R/construct_data.R#L264   } ...
R/construct_data.R#L265   else { ...
R/construct_data.R#L268   } ...
R/construct_data.R#L269    ...
R/construct_data.R#L270   rownames(covariate_new) <- paste0("Cel ...
R/construct_data.R#L271   return(covariate_new) ...
R/extract_para.R#L71                           assay_use = "c ...
R/extract_para.R#L72                           marginal_list, ...
R/extract_para.R#L73                           n_cores, ...
R/extract_para.R#L74                           family_use, ...
R/extract_para.R#L75                           new_covariate, ...
R/extract_para.R#L76                           parallelizatio ...
R/extract_para.R#L77                           BPPARAM = NULL ...
R/extract_para.R#L78                           data) { ...
R/extract_para.R#L79   removed_cell_list <- lapply(marginal_l ...
R/extract_para.R#L80   marginal_list <- lapply(marginal_list, ...
R/extract_para.R#L82   # find gene whose marginal is fitted ...
R/extract_para.R#L83   qc_gene_idx <- which(!is.na(marginal_l ...
R/extract_para.R#L84   if(length(family_use) != 1){ ...
R/extract_para.R#L86   } ...
R/extract_para.R#L87   # check if user inputted new covariate ...
R/extract_para.R#L88   data_temp <- data[,colnames(new_covari ...
R/extract_para.R#L89   if(identical(data_temp, new_covariate) ...
R/extract_para.R#L91   } ...
R/extract_para.R#L92    ...
R/extract_para.R#L93   count_mat <- SummarizedExperiment::ass ...
R/extract_para.R#L94    ...
R/extract_para.R#L95   mat_function <-function(x, y) { ...
R/extract_para.R#L108       total_cells <- dim(sce)[2] ...
R/extract_para.R#L109       cell_names <- colnames(sce) ...
R/extract_para.R#L111       total_cells <- dim(new_covariate)[ ...
R/extract_para.R#L112       cell_names <- rownames(new_covaria ...
R/extract_para.R#L116       if(is.null(new_covariate)){ ...
R/extract_para.R#L118       }else{ ...
R/extract_para.R#L120           all_covariates <- all.vars(fit ...
R/extract_para.R#L122           all_covariates <- all.vars(fit ...
R/extract_para.R#L125           curr_x <- tapply(data$gene, da ...
R/extract_para.R#L126           zero_group <- which(curr_x==0) ...
R/extract_para.R#L127           if(length(zero_group) == 0){ ...
R/extract_para.R#L129           }else{ ...
R/extract_para.R#L132           } ...
R/extract_para.R#L138           new_covariate <- new_covariate ...
R/extract_para.R#L140       } ...
R/extract_para.R#L144       mean_vec <- ...
R/extract_para.R#L146                        type = "response" ...
R/extract_para.R#L147                        what = "mu", ...
R/extract_para.R#L148                        newdata = new_cov ...
R/extract_para.R#L149       if (y == "poisson" | y == "binomia ...
R/extract_para.R#L151       } else if (y == "gaussian") { ...
R/extract_para.R#L153                                    type  ...
R/extract_para.R#L154                                    what  ...
R/extract_para.R#L155                                    newda ...
R/extract_para.R#L156       } else if (y == "nb") { ...
R/extract_para.R#L158           stats::predict(fit, ...
R/extract_para.R#L159                          type = "respons ...
R/extract_para.R#L160                          what = "sigma", ...
R/extract_para.R#L161                          newdata = new_c ...
R/extract_para.R#L163       } else if (y == "zip") { ...
R/extract_para.R#L166           stats::predict(fit, ...
R/extract_para.R#L167                          type = "respons ...
R/extract_para.R#L168                          what = "sigma", ...
R/extract_para.R#L169                          newdata = new_c ...
R/extract_para.R#L170       } else if (y == "zinb") { ...
R/extract_para.R#L172           stats::predict(fit, ...
R/extract_para.R#L173                          type = "respons ...
R/extract_para.R#L174                          what = "sigma", ...
R/extract_para.R#L175                          newdata = new_c ...
R/extract_para.R#L177           stats::predict(fit, ...
R/extract_para.R#L178                          type = "respons ...
R/extract_para.R#L179                          what = "nu", ...
R/extract_para.R#L180                          newdata = new_c ...
R/extract_para.R#L181       } else { ...
R/extract_para.R#L183       } ...
R/extract_para.R#L185       ## Fit is mgcv::gam ...
R/extract_para.R#L186       if (is.null(new_covariate)) { ...
R/extract_para.R#L189           y <- "nb" ...
R/extract_para.R#L194           theta_vec <- rep(NA,  total_ce ...
R/extract_para.R#L196           theta_vec <- rep(sqrt(fit$sig2 ...
R/extract_para.R#L198           theta <- fit$family$getTheta(T ...
R/extract_para.R#L199           theta_vec <- 1/rep(theta, tota ...
R/extract_para.R#L201           stop("Distribution of gamlss m ...
R/extract_para.R#L203       } else{ ...
R/extract_para.R#L206           y <- "nb" ...
R/extract_para.R#L211           stats::predict(fit, type = "re ...
R/extract_para.R#L213           theta_vec <- rep(NA, total_cel ...
R/extract_para.R#L215           theta_vec = stats::predict(fit ...
R/extract_para.R#L216                                      typ ...
R/extract_para.R#L217                                      wha ...
R/extract_para.R#L218                                      new ...
R/extract_para.R#L220           theta <- fit$family$getTheta(T ...
R/extract_para.R#L221           theta_vec <- 1/rep(theta, tota ...
R/extract_para.R#L223           stop("Distribution of gam must ...
R/extract_para.R#L225       } ...
R/extract_para.R#L229       zero_vec <- rep(0, length(mean_vec ...
R/extract_para.R#L230       names(zero_vec) <- names(mean_vec) ...
R/extract_para.R#L234       full_means <- rep(0, total_cells) ...
R/extract_para.R#L235       names(full_means) <- cell_names ...
R/extract_para.R#L236       full_means[names(mean_vec)] <- mea ...
R/extract_para.R#L237       full_theta <- rep(NA, total_cells) ...
R/extract_para.R#L238       names(full_theta) <- cell_names ...
R/extract_para.R#L239       full_zero <- rep(NA, total_cells) ...
R/extract_para.R#L240       names(full_zero) <- cell_names ...
R/extract_para.R#L241       if(is.null(names(theta_vec))){ ...
R/extract_para.R#L243           names(theta_vec) <- names(mean ...
R/extract_para.R#L245           names(theta_vec) <- cell_names ...
R/extract_para.R#L248       } ...
R/extract_para.R#L249       full_theta[names(theta_vec)] <- th ...
R/extract_para.R#L250       full_zero[names(zero_vec)] <- zero ...
R/extract_para.R#L251       mean_vec <- full_means ...
R/extract_para.R#L252       theta_vec <- full_theta ...
R/extract_para.R#L253       zero_vec <- full_zero ...
R/extract_para.R#L262   } ...
R/extract_para.R#L263   paraFunc <- parallel::mcmapply ...
R/extract_para.R#L264   if(.Platform$OS.type == "windows"){ ...
R/extract_para.R#L267   } ...
R/extract_para.R#L268   if(parallelization == "bpmapply"){ ...
R/extract_para.R#L270   } ...
R/extract_para.R#L271   if(parallelization == "pbmcmapply"){ ...
R/extract_para.R#L273   } ...
R/extract_para.R#L274   if(parallelization == "bpmapply"){ ...
R/extract_para.R#L277       BPPARAM$workers <- n_cores ...
R/extract_para.R#L280   }else{ ...
R/extract_para.R#L282                                   ,mc.co ...
R/extract_para.R#L283                                    )) ...
R/extract_para.R#L284   } ...
R/extract_para.R#L285   mean_mat <- sapply(mat, function(x) ...
R/extract_para.R#L287   sigma_mat <- sapply(mat, function(x) ...
R/extract_para.R#L289   zero_mat <- sapply(mat, function(x) ...
R/extract_para.R#L292   if(length(qc_gene_idx) < dim(sce)[1]){ ...
R/extract_para.R#L294       colnames(sigma_mat) <- colnames(ze ...
R/extract_para.R#L307   }else{ ...
R/extract_para.R#L309       colnames(sigma_mat) <- colnames(ze ...
R/extract_para.R#L310   } ...
R/extract_para.R#L312   zero_mat <- Matrix::Matrix(zero_mat, s ...
R/extract_para.R#L313   return(list( ...
R/extract_para.R#L317   )) ...
R/fit_copula.R#L80                        assay_use, ...
R/fit_copula.R#L81                        input_data, ...
R/fit_copula.R#L82                        empirical_quantil ...
R/fit_copula.R#L83                        marginal_list, ...
R/fit_copula.R#L84                        family_use, ...
R/fit_copula.R#L85                        copula = 'gaussia ...
R/fit_copula.R#L86                        DT = TRUE, ...
R/fit_copula.R#L87                        pseudo_obs = FALS ...
R/fit_copula.R#L88                        epsilon = 1e-6, ...
R/fit_copula.R#L89                        family_set = c("g ...
R/fit_copula.R#L90                        important_feature ...
R/fit_copula.R#L91                        if_sparse = FALSE ...
R/fit_copula.R#L92                        correlation_funct ...
R/fit_copula.R#L93                        n_cores, ...
R/fit_copula.R#L94                        parallelization = ...
R/fit_copula.R#L95                        BPPARAM = NULL) { ...
R/fit_copula.R#L97   if(empirical_quantile == TRUE) { ...
R/fit_copula.R#L98       message("Use the empirical quantil ...
R/fit_copula.R#L99   } ...
R/fit_copula.R#L100    ...
R/fit_copula.R#L101   if(identical(important_feature, "all") ...
R/fit_copula.R#L103   } ...
R/fit_copula.R#L104    ...
R/fit_copula.R#L105   marginals <- lapply(marginal_list, fun ...
R/fit_copula.R#L106   # find gene whose marginal is fitted ...
R/fit_copula.R#L107   qc_gene_idx <- which(!is.na(marginals) ...
R/fit_copula.R#L108   if(length(family_use) != 1){ ...
R/fit_copula.R#L110   } ...
R/fit_copula.R#L111   group_index <- unique(input_data$corr_ ...
R/fit_copula.R#L112   ind <- group_index[1] == "ind" ...
R/fit_copula.R#L113   if(ind) { ...
R/fit_copula.R#L124       list( ...
R/fit_copula.R#L130       ) ...
R/fit_copula.R#L132   } ...
R/fit_copula.R#L134   if(empirical_quantile == TRUE) { ...
R/fit_copula.R#L137       if(length(important_feature) != di ...
R/fit_copula.R#L139       } ...
R/fit_copula.R#L141       if(is.numeric(important_feature)){ ...
R/fit_copula.R#L144           sum(y < 1e-5) / dim(sce)[2] ...
R/fit_copula.R#L148       }else{ ...
R/fit_copula.R#L150       } ...
R/fit_copula.R#L161       message(paste0("Empirical quantile ...
R/fit_copula.R#L162       sce <- sce[important_feature, ] ...
R/fit_copula.R#L163       curr_index <- which(corr_group[, 1 ...
R/fit_copula.R#L164        ...
R/fit_copula.R#L165       newmat <- SummarizedExperiment::as ...
R/fit_copula.R#L166       newmat <- t(as.matrix(newmat)) ...
R/fit_copula.R#L167        ...
R/fit_copula.R#L168       newmvq <- rvinecopulib::pseudo_obs ...
R/fit_copula.R#L169       newmvq ...
R/fit_copula.R#L172        ...
R/fit_copula.R#L177            model_bic = 0, ...
R/fit_copula.R#L178            quantile_mat = newmvq, ...
R/fit_copula.R#L179            important_feature = important ...
R/fit_copula.R#L181   } else { ...
R/fit_copula.R#L183       message("Convert Residuals to Mult ...
R/fit_copula.R#L184       newmat <- convert_n( ...
R/fit_copula.R#L196       ) ...
R/fit_copula.R#L197       message("Converting End") ...
R/fit_copula.R#L199       message("Convert Residuals to Unif ...
R/fit_copula.R#L200       newmat <- convert_u( ...
R/fit_copula.R#L212       ) ...
R/fit_copula.R#L213       message("Converting End") ...
R/fit_copula.R#L218       if(length(important_feature) != di ...
R/fit_copula.R#L220       } ...
R/fit_copula.R#L222       if(is.numeric(important_feature)){ ...
R/fit_copula.R#L225           sum(y < 1e-5) / dim(sce)[2] ...
R/fit_copula.R#L229       }else{ ...
R/fit_copula.R#L231       } ...
R/fit_copula.R#L239     ...
R/fit_copula.R#L242       lapply(group_index, function(x, ...
R/fit_copula.R#L243                                    sce, ...
R/fit_copula.R#L244                                    newma ...
R/fit_copula.R#L245                                    corr_ ...
R/fit_copula.R#L246                                    ind, ...
R/fit_copula.R#L247                                    n_cor ...
R/fit_copula.R#L248                                    impor ...
R/fit_copula.R#L251         ...
R/fit_copula.R#L253           #message(paste0("Group ", grou ...
R/fit_copula.R#L254           curr_mat <- newmat[curr_index, ...
R/fit_copula.R#L255           #message("Cal MVN") ...
R/fit_copula.R#L256           cor.mat <- cal_cor( ...
R/fit_copula.R#L264           ) ...
R/fit_copula.R#L265            ...
R/fit_copula.R#L266           #message("Sample MVN") ...
R/fit_copula.R#L267           #new_mvu <- sampleMVN(n = curr ...
R/fit_copula.R#L268           #                     Sigma =  ...
R/fit_copula.R#L269           #message("MVN Sampling End") ...
R/fit_copula.R#L270           #rownames(new_mvu) <- curr_nce ...
R/fit_copula.R#L271            ...
R/fit_copula.R#L272           #message("Cal AIC/BIC Start") ...
R/fit_copula.R#L273           model_aic <- cal_aic(norm.mat  ...
R/fit_copula.R#L274                                cor.mat = ...
R/fit_copula.R#L275                                ind = ind ...
R/fit_copula.R#L276           model_bic <- cal_bic(norm.mat  ...
R/fit_copula.R#L277                                cor.mat = ...
R/fit_copula.R#L278                                ind = ind ...
R/fit_copula.R#L279           #message("Cal AIC/BIC End") ...
R/fit_copula.R#L280            ...
R/fit_copula.R#L282           message("Vine Copula Estimatio ...
R/fit_copula.R#L283           start <- Sys.time() ...
R/fit_copula.R#L284           curr_mat <- newmat[curr_index, ...
R/fit_copula.R#L285           curr_mat <- curr_mat[,which(im ...
R/fit_copula.R#L286           vine.fit <- rvinecopulib::vine ...
R/fit_copula.R#L292           ) ...
R/fit_copula.R#L293           end <- Sys.time() ...
R/fit_copula.R#L294           print(end - start) ...
R/fit_copula.R#L295           message("Vine Copula Estimatio ...
R/fit_copula.R#L296           # if (curr_ncell != 0) { ...
R/fit_copula.R#L297           #   message("Sampling Vine Cop ...
R/fit_copula.R#L298           #   new_mvu <- rvinecopulib::r ...
R/fit_copula.R#L299           #     curr_ncell, ...
R/fit_copula.R#L300           #     vine = vine.fit, ...
R/fit_copula.R#L301           #     cores = n_cores, ...
R/fit_copula.R#L302           #     qrng = TRUE ...
R/fit_copula.R#L303           #   ) ...
R/fit_copula.R#L304           #   message("Sampling Vine Cop ...
R/fit_copula.R#L305           #   rownames(new_mvu) <- curr_ ...
R/fit_copula.R#L306           # } else{ ...
R/fit_copula.R#L307           #   new_mvu <- NULL ...
R/fit_copula.R#L308           # } ...
R/fit_copula.R#L309           model_aic <- stats::AIC(vine.f ...
R/fit_copula.R#L310           model_bic <- stats::BIC(vine.f ...
R/fit_copula.R#L311           cor.mat <- vine.fit ...
R/fit_copula.R#L313           stop("Copula must be one of 'v ...
R/fit_copula.R#L316           list( ...
R/fit_copula.R#L321           ) ...
R/fit_copula.R#L323       }, sce = sce,  ...
R/fit_copula.R#L324       newmat = newmat,  ...
R/fit_copula.R#L325       ind = ind,  ...
R/fit_copula.R#L326       n_cores = n_cores,  ...
R/fit_copula.R#L327       corr_group = corr_group, ...
R/fit_copula.R#L328       important_feature = important_feat ...
R/fit_copula.R#L335       x$model_aic)) ...
R/fit_copula.R#L339       x$model_bic)) ...
R/fit_copula.R#L349       x$cor.mat) ...
R/fit_copula.R#L356       list( ...
R/fit_copula.R#L362       ) ...
R/fit_copula.R#L364   } ...
R/fit_copula.R#L376   if (ind) { ...
R/fit_copula.R#L379   } ...
R/fit_copula.R#L380   else { ...
R/fit_copula.R#L386       important_cor.mat <- sparse_cov(im ...
R/fit_copula.R#L387                                method =  ...
R/fit_copula.R#L388                                operator  ...
R/fit_copula.R#L389                                corr = TR ...
R/fit_copula.R#L391       important_cor.mat <- correlation(i ...
R/fit_copula.R#L397       important_cor.mat[is.na(important_ ...
R/fit_copula.R#L400   } ...
R/fit_copula.R#L402   n <- dim(cor.mat)[1] ...
R/fit_copula.R#L404   ### We currently gave up this because  ...
R/fit_copula.R#L405   # if (if_sparse) { ...
R/fit_copula.R#L406   #   ifposd <- matrixcalc::is.positive. ...
R/fit_copula.R#L407   #   if (!ifposd) { ...
R/fit_copula.R#L408   #     warning("Cor matrix is not posit ...
R/fit_copula.R#L409   #     #diag(cor.mat) <- diag(cor.mat)  ...
R/fit_copula.R#L410   #   } ...
R/fit_copula.R#L411   #   ## Call spcov ...
R/fit_copula.R#L412   #   lambda_matrix <- matrix(rep(1, n ^ ...
R/fit_copula.R#L413   #   diag(lambda_matrix) <- 0 ...
R/fit_copula.R#L414   #   scor <- spcov::spcov( ...
R/fit_copula.R#L415   #     cor.mat, ...
R/fit_copula.R#L416   #     cor.mat, ...
R/fit_copula.R#L417   #     lambda = lambda_matrix, ...
R/fit_copula.R#L418   #     step.size  = 100, ...
R/fit_copula.R#L419   #     trace = 1, ...
R/fit_copula.R#L420   #     n.inner.steps = 200, ...
R/fit_copula.R#L421   #     thr.inner = tol ...
R/fit_copula.R#L422   #   ) ...
R/fit_copula.R#L423   #   cor.mat <- scor$Sigma ...
R/fit_copula.R#L424   # } ...
R/fit_copula.R#L425   if (if_sparse) { ...
R/fit_copula.R#L426   cor.mat <- methods::as(methods::as(met ...
R/fit_copula.R#L427   } ...
R/fit_copula.R#L428   cor.mat ...
R/fit_copula.R#L433                       assay_use, ...
R/fit_copula.R#L434                       marginal_list, ...
R/fit_copula.R#L435                       data, ...
R/fit_copula.R#L436                       DT = TRUE, ...
R/fit_copula.R#L437                       pseudo_obs = FALSE ...
R/fit_copula.R#L438                       epsilon = 1e-6, ...
R/fit_copula.R#L439                       family_use, ...
R/fit_copula.R#L440                       n_cores, ...
R/fit_copula.R#L441                       parallelization, ...
R/fit_copula.R#L442                       BPPARAM) { ...
R/fit_copula.R#L443   ## Extract count matrix ...
R/fit_copula.R#L444   count_mat <- ...
R/fit_copula.R#L445       t(as.matrix(SummarizedExperiment:: ...
R/fit_copula.R#L446   removed_cell_list <- lapply(marginal_l ...
R/fit_copula.R#L447   marginal_list <- lapply(marginal_list, ...
R/fit_copula.R#L448   # n cell ...
R/fit_copula.R#L449   ncell <- dim(count_mat)[1] ...
R/fit_copula.R#L452   mat_function <- function(x, y) { ...
R/fit_copula.R#L456       data<- data[-removed_cell,] ...
R/fit_copula.R#L459       mean_vec <- stats::predict(fit, ty ...
R/fit_copula.R#L460       if (y == "poisson" | y == "binomia ...
R/fit_copula.R#L462       } else if (y == "gaussian") { ...
R/fit_copula.R#L464           stats::predict(fit, type = "re ...
R/fit_copula.R#L465       } else if (y == "nb") { ...
R/fit_copula.R#L467           1 / stats::predict(fit, type = ...
R/fit_copula.R#L469       } else if (y == "zip") { ...
R/fit_copula.R#L472           stats::predict(fit, type = "re ...
R/fit_copula.R#L473       } else if (y == "zinb") { ...
R/fit_copula.R#L476           stats::predict(fit, type = "re ...
R/fit_copula.R#L477       } else { ...
R/fit_copula.R#L479       } ...
R/fit_copula.R#L481       ## if input is from mgcv ...
R/fit_copula.R#L482       ## Check the family (since sometim ...
R/fit_copula.R#L484       y <- stats::family(fit)$family[1] ...
R/fit_copula.R#L485       if (grepl("Negative Binomial", y)) ...
R/fit_copula.R#L487       } ...
R/fit_copula.R#L489       mean_vec <- stats::predict(fit, ty ...
R/fit_copula.R#L490       if (y == "poisson" | y == "binomia ...
R/fit_copula.R#L492       } else if (y == "gaussian") { ...
R/fit_copula.R#L494       } else if (y == "nb") { ...
R/fit_copula.R#L497       } else { ...
R/fit_copula.R#L499       } ...
R/fit_copula.R#L510       zero_vec <- 0 ...
R/fit_copula.R#L514       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L516       }) ...
R/fit_copula.R#L518       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L520       }) ...
R/fit_copula.R#L522       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L524       }) ...
R/fit_copula.R#L526       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L528       }) ...
R/fit_copula.R#L530       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L532       }) ...
R/fit_copula.R#L535       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L540       }) ...
R/fit_copula.R#L542       stop("Distribution of gamlss must  ...
R/fit_copula.R#L547       if (y == "poisson") { ...
R/fit_copula.R#L549           stats::ppois(x[1] - 1, lambda  ...
R/fit_copula.R#L551       } else if (y == "gaussian" | y ==  ...
R/fit_copula.R#L559       } else if (y == "nb") { ...
R/fit_copula.R#L561           stats::pnbinom(x[1] - 1, mu =  ...
R/fit_copula.R#L563       } else if (y == "zip") { ...
R/fit_copula.R#L565           ifelse(x[1] > 0, gamlss.dist:: ...
R/fit_copula.R#L567       } else if (y == "zinb") { ...
R/fit_copula.R#L569           ifelse(x[1] > 0, ...
R/fit_copula.R#L570                  gamlss.dist::pZINBI( ...
R/fit_copula.R#L571                    x[1] - 1, ...
R/fit_copula.R#L572                    mu = x[2], ...
R/fit_copula.R#L573                    sigma = abs(x[3]), ...
R/fit_copula.R#L574                    nu = x[4] ...
R/fit_copula.R#L575                  ), ...
R/fit_copula.R#L576                  0) ...
R/fit_copula.R#L578       } else { ...
R/fit_copula.R#L580       } ...
R/fit_copula.R#L582       u1 <- pvec ...
R/fit_copula.R#L583       u2 <- pvec2 ...
R/fit_copula.R#L585       v <- stats::runif(length(mean_vec) ...
R/fit_copula.R#L586       ## Random mapping ...
R/fit_copula.R#L587       r <- u1 * v + u2 * (1 - v) ...
R/fit_copula.R#L589       r <- pvec ...
R/fit_copula.R#L593       new_r <- rep(1, dim(sce)[2]) ...
R/fit_copula.R#L594       names(new_r) <- colnames(sce) ...
R/fit_copula.R#L595       new_r[names(r)] <- r ...
R/fit_copula.R#L596       r <- new_r ...
R/fit_copula.R#L606       r <- rvinecopulib::pseudo_obs(r) ...
R/fit_copula.R#L610       r, ...
R/fit_copula.R#L611       mean = 0, ...
R/fit_copula.R#L612       sd = 1, ...
R/fit_copula.R#L613       lower.tail = TRUE, ...
R/fit_copula.R#L614       log.p = FALSE ...
R/fit_copula.R#L616   } ...
R/fit_copula.R#L618   paraFunc <- parallel::mcmapply ...
R/fit_copula.R#L619   if(.Platform$OS.type == "windows"){ ...
R/fit_copula.R#L622   } ...
R/fit_copula.R#L623   if(parallelization == "bpmapply"){ ...
R/fit_copula.R#L625   } ...
R/fit_copula.R#L626   if(parallelization == "pbmcmapply"){ ...
R/fit_copula.R#L628   } ...
R/fit_copula.R#L629   if(parallelization == "bpmapply"){ ...
R/fit_copula.R#L631       BPPARAM$workers <- n_cores ...
R/fit_copula.R#L634   }else{ ...
R/fit_copula.R#L636   } ...
R/fit_copula.R#L637   colnames(mat) <- rownames(sce) ...
R/fit_copula.R#L638   rownames(mat) <- colnames(sce) ...
R/fit_copula.R#L640   ## Remove inf ...
R/fit_copula.R#L641   mat[is.infinite(mat)] <- NA ...
R/fit_copula.R#L643   for (i in 1:ncol(mat)) { ...
R/fit_copula.R#L645   } ...
R/fit_copula.R#L647   return(mat) ...
R/fit_copula.R#L652                       assay_use, ...
R/fit_copula.R#L653                       marginal_list, ...
R/fit_copula.R#L654                       data, ...
R/fit_copula.R#L655                       DT = TRUE, ...
R/fit_copula.R#L656                       pseudo_obs = FALSE ...
R/fit_copula.R#L657                       epsilon = 1e-6, ...
R/fit_copula.R#L658                       n_cores, ...
R/fit_copula.R#L659                       family_use, ...
R/fit_copula.R#L660                       parallelization, ...
R/fit_copula.R#L661                       BPPARAM) { ...
R/fit_copula.R#L662   ## Extract count matrix ...
R/fit_copula.R#L663   count_mat <- ...
R/fit_copula.R#L664       t(as.matrix(SummarizedExperiment:: ...
R/fit_copula.R#L665   removed_cell_list <- lapply(marginal_l ...
R/fit_copula.R#L666   marginal_list <- lapply(marginal_list, ...
R/fit_copula.R#L669   # n cell ...
R/fit_copula.R#L670   ncell <- dim(count_mat)[1] ...
R/fit_copula.R#L672   mat_function <- function(x, y) { ...
R/fit_copula.R#L676       data<- data[-removed_cell,] ...
R/fit_copula.R#L679       mean_vec <- stats::predict(fit, ty ...
R/fit_copula.R#L680       if (y == "poisson" | y == "binomia ...
R/fit_copula.R#L682       } else if (y == "gaussian") { ...
R/fit_copula.R#L684           stats::predict(fit, type = "re ...
R/fit_copula.R#L685       } else if (y == "nb") { ...
R/fit_copula.R#L687           1 / stats::predict(fit, type = ...
R/fit_copula.R#L689       } else if (y == "zip") { ...
R/fit_copula.R#L692           stats::predict(fit, type = "re ...
R/fit_copula.R#L693       } else if (y == "zinb") { ...
R/fit_copula.R#L696           stats::predict(fit, type = "re ...
R/fit_copula.R#L697       } else { ...
R/fit_copula.R#L699       } ...
R/fit_copula.R#L701       ## if input is from mgcv, update t ...
R/fit_copula.R#L702       y <- stats::family(fit)$family[1] ...
R/fit_copula.R#L703       if (grepl("Negative Binomial", y)) ...
R/fit_copula.R#L705       } ...
R/fit_copula.R#L707       mean_vec <- stats::predict(fit, ty ...
R/fit_copula.R#L708       if (y == "poisson" | y == "binomia ...
R/fit_copula.R#L710       } else if (y == "gaussian") { ...
R/fit_copula.R#L712       } else if (y == "nb") { ...
R/fit_copula.R#L715       } else { ...
R/fit_copula.R#L717       } ...
R/fit_copula.R#L728       zero_vec <- 0 ...
R/fit_copula.R#L733       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L735       }) ...
R/fit_copula.R#L737       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L739       }) ...
R/fit_copula.R#L741       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L743       }) ...
R/fit_copula.R#L745       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L747       }) ...
R/fit_copula.R#L749       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L751       }) ...
R/fit_copula.R#L754       pvec <- apply(family_frame, 1, fun ...
R/fit_copula.R#L759       }) ...
R/fit_copula.R#L761       stop("Distribution of gamlss must  ...
R/fit_copula.R#L766       if (y == "poisson") { ...
R/fit_copula.R#L768           stats::ppois(x[1] - 1, lambda  ...
R/fit_copula.R#L770       } else if (y == "gaussian" | y ==  ...
R/fit_copula.R#L777       } else if (y == "nb") { ...
R/fit_copula.R#L779           stats::pnbinom(x[1] - 1, mu =  ...
R/fit_copula.R#L781       } else if (y == "zip") { ...
R/fit_copula.R#L783           ifelse(x[1] > 0, gamlss.dist:: ...
R/fit_copula.R#L785       } else if (y == "zinb") { ...
R/fit_copula.R#L787           ifelse(x[1] > 0, ...
R/fit_copula.R#L788                  gamlss.dist::pZINBI( ...
R/fit_copula.R#L789                    x[1] - 1, ...
R/fit_copula.R#L790                    mu = x[2], ...
R/fit_copula.R#L791                    sigma = abs(x[3]), ...
R/fit_copula.R#L792                    nu = x[4] ...
R/fit_copula.R#L793                  ), ...
R/fit_copula.R#L794                  0) ...
R/fit_copula.R#L796       } else { ...
R/fit_copula.R#L798       } ...
R/fit_copula.R#L800       u1 <- pvec ...
R/fit_copula.R#L801       u2 <- pvec2 ...
R/fit_copula.R#L803       v <- stats::runif(length(mean_vec) ...
R/fit_copula.R#L804       ## Random mapping ...
R/fit_copula.R#L805       r <- u1 * v + u2 * (1 - v) ...
R/fit_copula.R#L807       r <- pvec ...
R/fit_copula.R#L811       new_r <- rep(1, dim(sce)[2]) ...
R/fit_copula.R#L812       names(new_r) <- colnames(sce) ...
R/fit_copula.R#L813       new_r[names(r)] <- r ...
R/fit_copula.R#L814       r <- new_r ...
R/fit_copula.R#L824       r <- rvinecopulib::pseudo_obs(r) ...
R/fit_copula.R#L828   } ...
R/fit_copula.R#L830   paraFunc <- parallel::mcmapply ...
R/fit_copula.R#L831   if(.Platform$OS.type == "windows"){ ...
R/fit_copula.R#L834   } ...
R/fit_copula.R#L835   if(parallelization == "bpmapply"){ ...
R/fit_copula.R#L837   } ...
R/fit_copula.R#L838   if(parallelization == "pbmcmapply"){ ...
R/fit_copula.R#L840   } ...
R/fit_copula.R#L841   if(parallelization == "bpmapply"){ ...
R/fit_copula.R#L843       BPPARAM$workers <- n_cores ...
R/fit_copula.R#L846   }else{ ...
R/fit_copula.R#L848   } ...
R/fit_copula.R#L849   colnames(mat) <- rownames(sce) ...
R/fit_copula.R#L850   rownames(mat) <- colnames(sce) ...
R/fit_copula.R#L852   ## Remove inf ...
R/fit_copula.R#L853   mat[is.infinite(mat)] <- NA ...
R/fit_copula.R#L855   ## Use mean to replace the missing val ...
R/fit_copula.R#L856   for (i in 1:ncol(mat)) { ...
R/fit_copula.R#L858   } ...
R/fit_copula.R#L860   quantile_mat <- mat ...
R/fit_copula.R#L861   return(quantile_mat) ...
R/fit_copula.R#L869   if (ind) { ...
R/fit_copula.R#L871   } else { ...
R/fit_copula.R#L876       -2 * (sum( ...
R/fit_copula.R#L878           x = norm.mat, ...
R/fit_copula.R#L879           mean = rep(0, dim(cor.mat)[1]) ...
R/fit_copula.R#L880           sigma = cor.mat, ...
R/fit_copula.R#L881           log = TRUE ...
R/fit_copula.R#L883       ) - sum(rowSums(stats::dnorm(norm. ...
R/fit_copula.R#L884   } ...
R/fit_copula.R#L886   copula.aic ...
R/fit_copula.R#L893   n_obs <- dim(norm.mat)[1] ...
R/fit_copula.R#L894   if (ind) { ...
R/fit_copula.R#L896   } else { ...
R/fit_copula.R#L901       -2 * (sum( ...
R/fit_copula.R#L903           x = norm.mat, ...
R/fit_copula.R#L904           mean = rep(0, dim(cor.mat)[1]) ...
R/fit_copula.R#L905           sigma = cor.mat, ...
R/fit_copula.R#L906           log = TRUE ...
R/fit_copula.R#L908       ) - sum(rowSums(stats::dnorm(norm. ...
R/fit_copula.R#L909   } ...
R/fit_copula.R#L911   copula.bic ...
R/fit_copula.R#L916   if(correlation_function == "default")  ...
R/fit_copula.R#L920   } else if (correlation_function == "co ...
R/fit_copula.R#L922   } else { ...
R/fit_copula.R#L924   } ...
R/fit_copula.R#L925    ...
R/fit_copula.R#L926    ...
R/fit_copula.R#L931   if(correlation_function == "default")  ...
R/fit_copula.R#L932   n <- dim(x)[1] ...
R/fit_copula.R#L933   m <- sqrt(n) * matrixStats::colMeans2( ...
R/fit_copula.R#L934   s <- (crossprod(x) - tcrossprod(m))/(n ...
R/fit_copula.R#L935   s} else if (correlation_function == "c ...
R/fit_copula.R#L937   } else { ...
R/fit_copula.R#L938   stop("correlation_function is either d ...
R/fit_copula.R#L939   } ...
R/fit_copula.R#L944                       Sigma,  ...
R/fit_copula.R#L945                       n_cores = n_cores, ...
R/fit_copula.R#L946                       fastmvn = fastmvn) ...
R/fit_copula.R#L947   if_sparse <- methods::is(Sigma, "dsCMa ...
R/fit_copula.R#L948   p <- dim(Sigma)[1] ...
R/fit_copula.R#L949   if(if_sparse) { ...
R/fit_copula.R#L952   } else { ...
R/fit_copula.R#L954       mvnrv <- mvnfast::rmvn(n, mu = rep ...
R/fit_copula.R#L956       mvnrv <- ...
R/fit_copula.R#L959   } ...
R/fit_copula.R#L960    ...
R/fit_copula.R#L961   mvnrvq <- apply(mvnrv, 2, stats::pnorm ...
R/fit_copula.R#L963   return(mvnrvq) ...
R/fit_copula.R#L971   if (checkSymmetry && !isSymmetric(sigm ...
R/fit_copula.R#L974   } ...
R/fit_copula.R#L975   if (length(mean) != nrow(sigma)) ...
R/fit_copula.R#L978   method <- match.arg(method) ...
R/fit_copula.R#L980   R <- if(method == "eigen") { ...
R/fit_copula.R#L983       warning("Sigma is numerically not  ...
R/fit_copula.R#L988   } ...
R/fit_copula.R#L989   else if(method == "svd"){ ...
R/fit_copula.R#L992       warning("Sigma is numerically not  ...
R/fit_copula.R#L995   } ...
R/fit_copula.R#L996   else if(method == "chol"){ ...
R/fit_copula.R#L999   } ...
R/fit_copula.R#L1001   retval <- matrix(stats::rnorm(as.doubl ...
R/fit_copula.R#L1002   retval <- sweep(retval, 2, mean, "+") ...
R/fit_copula.R#L1003   colnames(retval) <- names(mean) ...
R/fit_copula.R#L1004   retval ...
R/fit_marginal.R#L53                          predictor = "ge ...
R/fit_marginal.R#L54                          mu_formula, ...
R/fit_marginal.R#L55                          sigma_formula, ...
R/fit_marginal.R#L56                          family_use, ...
R/fit_marginal.R#L57                          n_cores, ...
R/fit_marginal.R#L58                          usebam = FALSE, ...
R/fit_marginal.R#L59                          edf_flexible =  ...
R/fit_marginal.R#L60                          parallelization ...
R/fit_marginal.R#L61                          BPPARAM = NULL, ...
R/fit_marginal.R#L62                          trace = FALSE,  ...
R/fit_marginal.R#L63                          simplify = FALS ...
R/fit_marginal.R#L64                          filter_cells =  ...
R/fit_marginal.R#L65   count_mat <-  data$count_mat ...
R/fit_marginal.R#L66   dat_cov <- data$dat ...
R/fit_marginal.R#L67   filtered_gene <- data$filtered_gene ...
R/fit_marginal.R#L68   feature_names <- colnames(count_mat) ...
R/fit_marginal.R#L69    ...
R/fit_marginal.R#L70    ...
R/fit_marginal.R#L71   # Extract K from mu formula ...
R/fit_marginal.R#L72   matches <- regexpr("k\\s*=\\s*([0-9]+) ...
R/fit_marginal.R#L73   extracted_value <- regmatches(mu_formu ...
R/fit_marginal.R#L74   extracted_K <- as.numeric(sub("k\\s*=\ ...
R/fit_marginal.R#L75   if(identical(extracted_K, numeric(0))) ...
R/fit_marginal.R#L77   } ...
R/fit_marginal.R#L78    ...
R/fit_marginal.R#L79   # Randomly select genes for edf fittin ...
R/fit_marginal.R#L80   num <- 100 ...
R/fit_marginal.R#L81   if(dim(count_mat)[2] > num & extracted ...
R/fit_marginal.R#L94   }else{ ...
R/fit_marginal.R#L96   } ...
R/fit_marginal.R#L97    ...
R/fit_marginal.R#L98    ...
R/fit_marginal.R#L99   ## Check family_use ...
R/fit_marginal.R#L100   if(length(family_use) == 1) { ...
R/fit_marginal.R#L102       edf_gini_family_use <- rep(family_ ...
R/fit_marginal.R#L103       edf_flexible_family_use <- rep(fam ...
R/fit_marginal.R#L106   } ...
R/fit_marginal.R#L107   if(length(family_use) != length(featur ...
R/fit_marginal.R#L109   } ...
R/fit_marginal.R#L110    ...
R/fit_marginal.R#L111    ...
R/fit_marginal.R#L112   fit_model_func <- function(gene, ...
R/fit_marginal.R#L113                              family_gene ...
R/fit_marginal.R#L114                              dat_use, ...
R/fit_marginal.R#L115                              #mgcv_formu ...
R/fit_marginal.R#L116                              mu_formula, ...
R/fit_marginal.R#L117                              sigma_formu ...
R/fit_marginal.R#L118                              predictor, ...
R/fit_marginal.R#L119                              count_mat, ...
R/fit_marginal.R#L120                              edf=NULL ...
R/fit_marginal.R#L121   ) { ...
R/fit_marginal.R#L124       mu_formula_ex <- sub("(k\\s*=).*", ...
R/fit_marginal.R#L125       mu_formula = paste0(mu_formula_ex, ...
R/fit_marginal.R#L129       stats::formula(paste0(predictor, " ...
R/fit_marginal.R#L137       fitfunc = mgcv::bam ...
R/fit_marginal.R#L139       fitfunc = mgcv::gam ...
R/fit_marginal.R#L143       terms <- attr(stats::terms(mgcv_fo ...
R/fit_marginal.R#L144       terms_smooth <- terms[which(grepl( ...
R/fit_marginal.R#L145        ...
R/fit_marginal.R#L146       if(usebam){ ...
R/fit_marginal.R#L149           mu_formula <- ...
R/fit_marginal.R#L152           terms_linear <- terms[which(!g ...
R/fit_marginal.R#L153           terms_update <- c(terms_linear ...
R/fit_marginal.R#L154           mu_formula <- ...
R/fit_marginal.R#L157       }else{ ...
R/fit_marginal.R#L160           mu_formula <- ...
R/fit_marginal.R#L163           terms_linear <- terms[which(!g ...
R/fit_marginal.R#L164           terms_update <- c(terms_linear ...
R/fit_marginal.R#L165           mu_formula <- ...
R/fit_marginal.R#L168       } ...
R/fit_marginal.R#L171       mu_formula <- stats::formula(paste ...
R/fit_marginal.R#L176       temp_sigma_formula <- stats::formu ...
R/fit_marginal.R#L177       terms <- attr(stats::terms(temp_si ...
R/fit_marginal.R#L178       terms_smooth <- terms[which(grepl( ...
R/fit_marginal.R#L179       if(usebam){ ...
R/fit_marginal.R#L182           sigma_formula <- ...
R/fit_marginal.R#L185           terms_linear <- terms[which(!g ...
R/fit_marginal.R#L186           terms_update <- c(terms_linear ...
R/fit_marginal.R#L187           sigma_formula <- ...
R/fit_marginal.R#L190       }else{ ...
R/fit_marginal.R#L193           sigma_formula <- ...
R/fit_marginal.R#L196           terms_linear <- terms[which(!g ...
R/fit_marginal.R#L197           terms_update <- c(terms_linear ...
R/fit_marginal.R#L198           sigma_formula <- ...
R/fit_marginal.R#L201       } ...
R/fit_marginal.R#L202        ...
R/fit_marginal.R#L204       sigma_formula <- stats::formula(pa ...
R/fit_marginal.R#L213       new_l <- logs ...
R/fit_marginal.R#L214       new_log <- list(function_name = fu ...
R/fit_marginal.R#L215                       type = type, ...
R/fit_marginal.R#L216                       message =  message ...
R/fit_marginal.R#L217       new_l[[length(new_l) + 1]]  <- new ...
R/fit_marginal.R#L218       logs <<- new_l ...
R/fit_marginal.R#L224       add_log("fit_marginal","warning",  ...
R/fit_marginal.R#L225       return(list(fit = NA, warning = lo ...
R/fit_marginal.R#L229       all_covariates <- all.vars(mgcv_fo ...
R/fit_marginal.R#L230       dat_cova <- dat_use[, all_covariat ...
R/fit_marginal.R#L231       check_factor <- all(sapply(dat_cov ...
R/fit_marginal.R#L232       if (length(all_covariates) > 0 & c ...
R/fit_marginal.R#L234           curr_x <- tapply(dat_use$gene, ...
R/fit_marginal.R#L235           zero_group <- which(curr_x==0) ...
R/fit_marginal.R#L236           if(length(zero_group) == 0){ ...
R/fit_marginal.R#L238           }else{ ...
R/fit_marginal.R#L241               return(list(idx = NA, chan ...
R/fit_marginal.R#L244           } ...
R/fit_marginal.R#L245            ...
R/fit_marginal.R#L251           remove_cell <- NA ...
R/fit_marginal.R#L253           remove_cell <- unique(stats::n ...
R/fit_marginal.R#L256           dat_use <- dat_use[-remove_cel ...
R/fit_marginal.R#L261           changeVars <- names(which(chan ...
R/fit_marginal.R#L262           formulaUpdate <- paste0(change ...
R/fit_marginal.R#L263           mgcv_formula <- stats::update. ...
R/fit_marginal.R#L264           mu_formula <- stats::update.fo ...
R/fit_marginal.R#L265           sigmaVars <- which(changeVars  ...
R/fit_marginal.R#L266           if(length(sigmaVars) > 0){ ...
R/fit_marginal.R#L268           } ...
R/fit_marginal.R#L269           sigma_formula = stats::update. ...
R/fit_marginal.R#L272       }else{ ...
R/fit_marginal.R#L274       } ...
R/fit_marginal.R#L276       remove_cell <- NA ...
R/fit_marginal.R#L283       mgcv.fit <- withCallingHandlers( ...
R/fit_marginal.R#L285           start.time <- Sys.time() ...
R/fit_marginal.R#L286           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L287           end.time <- Sys.time() ...
R/fit_marginal.R#L288           time <- as.numeric(end.time -  ...
R/fit_marginal.R#L289           time_list[1] <- time ...
R/fit_marginal.R#L290           res ...
R/fit_marginal.R#L292           add_log("gam","error", toStrin ...
R/fit_marginal.R#L293           NULL ...
R/fit_marginal.R#L295           add_log("gam","warning", toStr ...
R/fit_marginal.R#L296            ...
R/fit_marginal.R#L298        ...
R/fit_marginal.R#L299       if (sigma_formula != "~1") { ...
R/fit_marginal.R#L301           tryCatch({ ...
R/fit_marginal.R#L304               formula = mu_formula, ...
R/fit_marginal.R#L305               #sigma.formula = sigma_for ...
R/fit_marginal.R#L306               data = dat_use, ...
R/fit_marginal.R#L307               family = gamlss.dist::BI, ...
R/fit_marginal.R#L308               control = gamlss::gamlss.c ...
R/fit_marginal.R#L314           }, error=function(e) { ...
R/fit_marginal.R#L317           }), warning=function(w) { ...
R/fit_marginal.R#L319           }) ...
R/fit_marginal.R#L321       } else { ...
R/fit_marginal.R#L323       } ...
R/fit_marginal.R#L325       mgcv.fit <- withCallingHandlers( ...
R/fit_marginal.R#L327           start.time <- Sys.time() ...
R/fit_marginal.R#L328           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L329           end.time <- Sys.time() ...
R/fit_marginal.R#L330           time <- as.numeric(end.time -  ...
R/fit_marginal.R#L331           time_list[1] <- time ...
R/fit_marginal.R#L332           res ...
R/fit_marginal.R#L334           add_log("gam","error", toStrin ...
R/fit_marginal.R#L335           NULL ...
R/fit_marginal.R#L337           add_log("gam","warning", toStr ...
R/fit_marginal.R#L339        ...
R/fit_marginal.R#L340       if (sigma_formula != "~1") { ...
R/fit_marginal.R#L342           tryCatch({ ...
R/fit_marginal.R#L345               formula = mu_formula, ...
R/fit_marginal.R#L346               #sigma.formula = sigma_for ...
R/fit_marginal.R#L347               data = dat_use, ...
R/fit_marginal.R#L348               family = gamlss.dist::PO, ...
R/fit_marginal.R#L349               control = gamlss::gamlss.c ...
R/fit_marginal.R#L354           }, error=function(e) { ...
R/fit_marginal.R#L357           }), warning=function(w) { ...
R/fit_marginal.R#L359           }) ...
R/fit_marginal.R#L360       } else { ...
R/fit_marginal.R#L362       } ...
R/fit_marginal.R#L364       mgcv.fit <- withCallingHandlers( ...
R/fit_marginal.R#L366           start.time <- Sys.time() ...
R/fit_marginal.R#L367           res <- fitfunc(formula = mgcv_ ...
R/fit_marginal.R#L368           end.time <- Sys.time() ...
R/fit_marginal.R#L369           time <- as.numeric(end.time -  ...
R/fit_marginal.R#L370           time_list[1] <- time ...
R/fit_marginal.R#L371           res ...
R/fit_marginal.R#L373           add_log("gam","error", toStrin ...
R/fit_marginal.R#L374           NULL ...
R/fit_marginal.R#L376           add_log("gam","warning", toStr ...
R/fit_marginal.R#L378        ...
R/fit_marginal.R#L379       if (sigma_formula != "~1") { ...
R/fit_marginal.R#L381           tryCatch({ ...
R/fit_marginal.R#L384               formula = mu_formula, ...
R/fit_marginal.R#L385               sigma.formula = sigma_form ...
R/fit_marginal.R#L386               data = dat_use, ...
R/fit_marginal.R#L387               family = gamlss.dist::NO, ...
R/fit_marginal.R#L388               control = gamlss::gamlss.c ...
R/fit_marginal.R#L394           }, error=function(e) { ...
R/fit_marginal.R#L397           }), warning=function(w) { ...
R/fit_marginal.R#L399           }) ...
R/fit_marginal.R#L401       } else { ...
R/fit_marginal.R#L403       } ...
R/fit_marginal.R#L405       mgcv.fit <- withCallingHandlers( ...
R/fit_marginal.R#L407           start.time <- Sys.time() ...
R/fit_marginal.R#L408           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L409           end.time <- Sys.time() ...
R/fit_marginal.R#L410           time <- as.numeric(end.time -  ...
R/fit_marginal.R#L411           time_list[1] <- time ...
R/fit_marginal.R#L412           res ...
R/fit_marginal.R#L414           add_log("gam","error", toStrin ...
R/fit_marginal.R#L415           NULL ...
R/fit_marginal.R#L417           add_log("gam","warning", toStr ...
R/fit_marginal.R#L419        ...
R/fit_marginal.R#L420       if (sigma_formula != "~1") { ...
R/fit_marginal.R#L422           tryCatch({ ...
R/fit_marginal.R#L425               formula = mu_formula, ...
R/fit_marginal.R#L426               sigma.formula = sigma_form ...
R/fit_marginal.R#L427               data = dat_use, ...
R/fit_marginal.R#L428               family = gamlss.dist::NBI, ...
R/fit_marginal.R#L429               control = gamlss::gamlss.c ...
R/fit_marginal.R#L435           }, error=function(e) { ...
R/fit_marginal.R#L438           }), warning=function(w) { ...
R/fit_marginal.R#L440           }) ...
R/fit_marginal.R#L441       } else { ...
R/fit_marginal.R#L443       } ...
R/fit_marginal.R#L445       mgcv.fit <- withCallingHandlers( ...
R/fit_marginal.R#L447           start.time <- Sys.time() ...
R/fit_marginal.R#L448           res <-fitfunc(formula = mgcv_f ...
R/fit_marginal.R#L449           end.time <- Sys.time() ...
R/fit_marginal.R#L450           time <- as.numeric(end.time -  ...
R/fit_marginal.R#L451           time_list[1] <- time ...
R/fit_marginal.R#L452           res ...
R/fit_marginal.R#L454           add_log("gam","error", toStrin ...
R/fit_marginal.R#L455           NULL ...
R/fit_marginal.R#L457           add_log("gam","warning", toStr ...
R/fit_marginal.R#L459       gamlss.fit <- withCallingHandlers( ...
R/fit_marginal.R#L461           start.time = Sys.time() ...
R/fit_marginal.R#L462           res <- gamlss::gamlss( ...
R/fit_marginal.R#L469           ) ...
R/fit_marginal.R#L470           end.time = Sys.time() ...
R/fit_marginal.R#L471           time = as.numeric(end.time - s ...
R/fit_marginal.R#L472           time_list[2] <- time ...
R/fit_marginal.R#L473           res ...
R/fit_marginal.R#L475           add_log("gamlss","error", toSt ...
R/fit_marginal.R#L476           NULL ...
R/fit_marginal.R#L478           add_log("gamlss","warning", to ...
R/fit_marginal.R#L480        ...
R/fit_marginal.R#L482       mgcv.fit <- withCallingHandlers( ...
R/fit_marginal.R#L484           start.time <- Sys.time() ...
R/fit_marginal.R#L485           res <- fitfunc(formula = mgcv_ ...
R/fit_marginal.R#L486           end.time <- Sys.time() ...
R/fit_marginal.R#L487           time <- as.numeric(end.time -  ...
R/fit_marginal.R#L488           time_list[1] <- time ...
R/fit_marginal.R#L489           res ...
R/fit_marginal.R#L491           add_log("gam","error", toStrin ...
R/fit_marginal.R#L492           NULL ...
R/fit_marginal.R#L494           add_log("gam","warning", toStr ...
R/fit_marginal.R#L496       gamlss.fit <- withCallingHandlers( ...
R/fit_marginal.R#L498           start.time = Sys.time() ...
R/fit_marginal.R#L499           res <- gamlss::gamlss( ...
R/fit_marginal.R#L506           ) ...
R/fit_marginal.R#L507           end.time = Sys.time() ...
R/fit_marginal.R#L508           time = as.numeric(end.time - s ...
R/fit_marginal.R#L509           time_list[2] <- time ...
R/fit_marginal.R#L510           res ...
R/fit_marginal.R#L512           add_log("gamlss","error", toSt ...
R/fit_marginal.R#L513           NULL ...
R/fit_marginal.R#L515           add_log("gamlss","warning", to ...
R/fit_marginal.R#L517        ...
R/fit_marginal.R#L519       stop("The regression distribution  ...
R/fit_marginal.R#L524       if (sigma_formula != "~1") { ...
R/fit_marginal.R#L528           ## check whether gam has warni ...
R/fit_marginal.R#L529           if(is.null(warn)){ ...
R/fit_marginal.R#L531           }else{ ...
R/fit_marginal.R#L533           } ...
R/fit_marginal.R#L535       } ...
R/fit_marginal.R#L536        ...
R/fit_marginal.R#L537       fit <- mgcv.fit ...
R/fit_marginal.R#L539        ...
R/fit_marginal.R#L540       mean_vec <- stats::predict(gamlss. ...
R/fit_marginal.R#L541       theta_vec <- ...
R/fit_marginal.R#L543        ...
R/fit_marginal.R#L544       if_infinite <- (sum(is.infinite(me ...
R/fit_marginal.R#L545       if_overmax <- (max(mean_vec, na.rm ...
R/fit_marginal.R#L546       if(family_gene %in% c("nb","zinb") ...
R/fit_marginal.R#L550       }else{ ...
R/fit_marginal.R#L552       } ...
R/fit_marginal.R#L553        ...
R/fit_marginal.R#L554        ...
R/fit_marginal.R#L555       if (if_infinite | if_overmax | if_ ...
R/fit_marginal.R#L559       } else if (stats::AIC(mgcv.fit) -  ...
R/fit_marginal.R#L561           gene, ...
R/fit_marginal.R#L562           "'s gamlss AIC is not signifin ...
R/fit_marginal.R#L565       } ...
R/fit_marginal.R#L566       else { ...
R/fit_marginal.R#L568       } ...
R/fit_marginal.R#L572       fit <- simplify_fit(fit) ...
R/fit_marginal.R#L576       return(list(fit = fit, warning = l ...
R/fit_marginal.R#L580   } ...
R/fit_marginal.R#L581    ...
R/fit_marginal.R#L582   paraFunc <- parallel::mcmapply ...
R/fit_marginal.R#L583   if(.Platform$OS.type == "windows"){ ...
R/fit_marginal.R#L586   } ...
R/fit_marginal.R#L587   if(parallelization == "bpmapply"){ ...
R/fit_marginal.R#L589   } ...
R/fit_marginal.R#L590   if(parallelization == "pbmcmapply"){ ...
R/fit_marginal.R#L592   } ...
R/fit_marginal.R#L593   # If not using edf flexible fitting ...
R/fit_marginal.R#L594   if(edf_fitting==FALSE){ ...
R/fit_marginal.R#L596       if(class(BPPARAM)[1] != "SerialPar ...
R/fit_marginal.R#L598       } ...
R/fit_marginal.R#L599       model_fit <- suppressMessages(para ...
R/fit_marginal.R#L600                                          ...
R/fit_marginal.R#L601                                          ...
R/fit_marginal.R#L602                                          ...
R/fit_marginal.R#L603                                          ...
R/fit_marginal.R#L604                                          ...
R/fit_marginal.R#L605                                          ...
R/fit_marginal.R#L606                                          ...
R/fit_marginal.R#L607                                          ...
R/fit_marginal.R#L609       model_fit <-  suppressMessages(par ...
R/fit_marginal.R#L610                                          ...
R/fit_marginal.R#L611                                          ...
R/fit_marginal.R#L612                                          ...
R/fit_marginal.R#L613                                          ...
R/fit_marginal.R#L614                                          ...
R/fit_marginal.R#L615                                          ...
R/fit_marginal.R#L616                                          ...
R/fit_marginal.R#L617                                          ...
R/fit_marginal.R#L618                                          ...
R/fit_marginal.R#L620   }else{  ...
R/fit_marginal.R#L624       if(class(BPPARAM)[1] != "SerialPar ...
R/fit_marginal.R#L626       } ...
R/fit_marginal.R#L627       # Fit model to selected edf_gini_g ...
R/fit_marginal.R#L628       model_fit_edf_gini <- suppressMess ...
R/fit_marginal.R#L629                                          ...
R/fit_marginal.R#L630                                          ...
R/fit_marginal.R#L631                                          ...
R/fit_marginal.R#L632                                          ...
R/fit_marginal.R#L633                                          ...
R/fit_marginal.R#L634                                          ...
R/fit_marginal.R#L635                                          ...
R/fit_marginal.R#L636                                          ...
R/fit_marginal.R#L638        ...
R/fit_marginal.R#L639       # Fit model to selected edf_gini_g ...
R/fit_marginal.R#L640       model_fit_edf_gini <-  suppressMes ...
R/fit_marginal.R#L641                                          ...
R/fit_marginal.R#L642                                          ...
R/fit_marginal.R#L643                                          ...
R/fit_marginal.R#L644                                          ...
R/fit_marginal.R#L645                                          ...
R/fit_marginal.R#L646                                          ...
R/fit_marginal.R#L647                                          ...
R/fit_marginal.R#L648                                          ...
R/fit_marginal.R#L649                                          ...
R/fit_marginal.R#L656       res_ind <- model_fit_edf_gini[i] ...
R/fit_marginal.R#L657       if(lengths(res_ind)==2){ ...
R/fit_marginal.R#L660       } ...
R/fit_marginal.R#L680       if(class(BPPARAM)[1] != "SerialPar ...
R/fit_marginal.R#L682       } ...
R/fit_marginal.R#L683       model_fit_edf_flexible <- suppress ...
R/fit_marginal.R#L684                                          ...
R/fit_marginal.R#L685                                          ...
R/fit_marginal.R#L686                                          ...
R/fit_marginal.R#L687                                          ...
R/fit_marginal.R#L688                                          ...
R/fit_marginal.R#L689                                          ...
R/fit_marginal.R#L690                                          ...
R/fit_marginal.R#L691                                          ...
R/fit_marginal.R#L692                                          ...
R/fit_marginal.R#L694       model_fit_edf_flexible <-  suppres ...
R/fit_marginal.R#L695                                          ...
R/fit_marginal.R#L696                                          ...
R/fit_marginal.R#L697                                          ...
R/fit_marginal.R#L698                                          ...
R/fit_marginal.R#L699                                          ...
R/fit_marginal.R#L700                                          ...
R/fit_marginal.R#L701                                          ...
R/fit_marginal.R#L702                                          ...
R/fit_marginal.R#L703                                          ...
R/fit_marginal.R#L704                                          ...
R/fit_marginal.R#L714       model_fit[[index]] <- model_fit_ed ...
R/fit_marginal.R#L717       model_fit[[index]] <- model_fit_ed ...
R/fit_marginal.R#L719   }  ...
R/fit_marginal.R#L720    ...
R/fit_marginal.R#L721   # if(!is.null(model_fit$warning)) { ...
R/fit_marginal.R#L722   #   #stop("Model has warning!") ...
R/fit_marginal.R#L723   #   model_fit <- model_fit$value ...
R/fit_marginal.R#L724   # } ...
R/fit_marginal.R#L725   return(model_fit) ...
R/fit_marginal.R#L729   ## This function is modified from http ...
R/fit_marginal.R#L730   cm$y = c() ...
R/fit_marginal.R#L731   #cm$model = c() ...
R/fit_marginal.R#L732    ...
R/fit_marginal.R#L733   cm$residuals = c() ...
R/fit_marginal.R#L734   cm$fitted.values = c() ...
R/fit_marginal.R#L735   cm$effects = c() ...
R/fit_marginal.R#L736   cm$qr$qr = c()   ...
R/fit_marginal.R#L737   cm$linear.predictors = c() ...
R/fit_marginal.R#L738   cm$weights = c() ...
R/fit_marginal.R#L739   cm$prior.weights = c() ...
R/fit_marginal.R#L740   cm$data = c() ...
R/fit_marginal.R#L741    ...
R/fit_marginal.R#L742   #cm$mu.x = c() ...
R/fit_marginal.R#L743   #cm$sigma.x = c() ...
R/fit_marginal.R#L744   #cm$nu.x = c() ...
R/fit_marginal.R#L745    ...
R/fit_marginal.R#L746   #cm$family$variance = c() ...
R/fit_marginal.R#L747   #cm$family$dev.resids = c() ...
R/fit_marginal.R#L748   #cm$family$aic = c() ...
R/fit_marginal.R#L749   #cm$family$validmu = c() ...
R/fit_marginal.R#L750   #cm$family$simulate = c() ...
R/fit_marginal.R#L751   attr(cm$terms,".Environment") = c() ...
R/fit_marginal.R#L752   attr(cm$formula,".Environment") = c() ...
R/fit_marginal.R#L753    ...
R/fit_marginal.R#L754   attr(cm$mu.terms,".Environment") = c() ...
R/fit_marginal.R#L755   attr(cm$mu.formula,".Environment") = c ...
R/fit_marginal.R#L756    ...
R/fit_marginal.R#L757   attr(cm$sigma.terms,".Environment") =  ...
R/fit_marginal.R#L758   attr(cm$sigma.formula,".Environment")  ...
R/fit_marginal.R#L759    ...
R/fit_marginal.R#L760   attr(cm$nu.terms,".Environment") = c() ...
R/fit_marginal.R#L761   attr(cm$nu.formula,".Environment") = c ...
R/fit_marginal.R#L762   cm ...
R/fit_marginal.R#L767   ox <- order(x) ...
R/fit_marginal.R#L768   x <- x[ox] ...
R/fit_marginal.R#L769   weights <- weights[ox]/sum(weights) ...
R/fit_marginal.R#L770   p <- cumsum(weights) ...
R/fit_marginal.R#L771   nu <- cumsum(weights*x) ...
R/fit_marginal.R#L772   n <- length(nu) ...
R/fit_marginal.R#L773   nu <- nu / nu[n] ...
R/fit_marginal.R#L774   sum(nu[-1]*p[-n]) - sum(nu[-n]*p[-1]) ...
R/gamlss_fix.R#L18   #------------------------------------- ...
R/gamlss_fix.R#L19   # function starts here ...
R/gamlss_fix.R#L20   #------------------------------------- ...
R/gamlss_fix.R#L21   scall <- deparse(sys.call(), width.cut ...
R/gamlss_fix.R#L22   if (!methods::is(formula, "formula")) ...
R/gamlss_fix.R#L24   # get where "gamlss" is in system call ...
R/gamlss_fix.R#L25   rexpr <- grepl("gamlss",sys.calls()) ...
R/gamlss_fix.R#L26   #rexpr <- grepl("stats::model.frame.de ...
R/gamlss_fix.R#L30   for (i in length(rexpr):1) { ...
R/gamlss_fix.R#L33       break ...
R/gamlss_fix.R#L34   } ...
R/gamlss_fix.R#L36   gamlss.env <- sys.frame(position) #gam ...
R/gamlss_fix.R#L37   #gamlss.env <- environment(formula) ...
R/gamlss_fix.R#L39   ## get the data ...
R/gamlss_fix.R#L40   ## this has been modified on the 12-12 ...
R/gamlss_fix.R#L41   ##  if model.frame.gamlss() is used as ...
R/gamlss_fix.R#L42   ## function does not fail (It need to  ...
R/gamlss_fix.R#L43   if (sys.call(position)[1] == "predict. ...
R/gamlss_fix.R#L46   } else if (sys.call(position)[1] == "g ...
R/gamlss_fix.R#L49       # if no data argument but the form ...
R/gamlss_fix.R#L50       Data <- stats::model.frame(formula ...
R/gamlss_fix.R#L52       # data argument in gamlss ...
R/gamlss_fix.R#L53       Data <- get("gamlsscall", envir =  ...
R/gamlss_fix.R#L55   } else { ...
R/gamlss_fix.R#L57   } ...
R/gamlss_fix.R#L58   Data <- data.frame(base::eval(substitu ...
R/gamlss_fix.R#L59   #------------------------------------- ...
R/gamlss_fix.R#L60   # new Daniil and Vlasis ...
R/gamlss_fix.R#L61   # Initialize gam ...
R/gamlss_fix.R#L62   formula <- ...
R/gamlss_fix.R#L65   Data$Y.var <- rep(0, nrow(Data)) ...
R/gamlss_fix.R#L66   G <- mgcv::gam( ...
R/gamlss_fix.R#L87   ) ...
R/gamlss_fix.R#L88   #------------------------------------- ...
R/gamlss_fix.R#L89   xvar <- rep(0,  dim(Data)[1]) ...
R/gamlss_fix.R#L90   attr(xvar, "formula")     <- formula ...
R/gamlss_fix.R#L91   attr(xvar, "control")     <- control ...
R/gamlss_fix.R#L92   attr(xvar, "gamlss.env") <- gamlss.env ...
R/gamlss_fix.R#L93   attr(xvar, "data")       <- as.data.fr ...
R/gamlss_fix.R#L94   attr(xvar, "call")       <- ...
R/gamlss_fix.R#L96   attr(xvar, "class")      <- "smooth" ...
R/gamlss_fix.R#L97   attr(xvar, "G")          <- G ...
R/gamlss_fix.R#L98   xvar ...
R/gamlss_fix.R#L114   #------------------------------------- ...
R/gamlss_fix.R#L115   # function starts here ...
R/gamlss_fix.R#L116   #------------------------------------- ...
R/gamlss_fix.R#L117   scall <- Reduce(paste, deparse(sys.cal ...
R/gamlss_fix.R#L118   if (!methods::is(formula, "formula")) ...
R/gamlss_fix.R#L120   # get where "gamlss" is in system call ...
R/gamlss_fix.R#L121   rexpr <- grepl("gamlss",sys.calls()) # ...
R/gamlss_fix.R#L122   #rexpr <- grepl("fitModel", sys.calls( ...
R/gamlss_fix.R#L123   #rexpr <- grepl("stats::model.frame.de ...
R/gamlss_fix.R#L125   for (i in length(rexpr):1) { ...
R/gamlss_fix.R#L128   } ...
R/gamlss_fix.R#L129   gamlss.env <- sys.frame(position) #gam ...
R/gamlss_fix.R#L130   ## get the data ...
R/gamlss_fix.R#L131   ## this has been modified on the 12-12 ...
R/gamlss_fix.R#L132   ##  if model.frame.gamlss() is used as ...
R/gamlss_fix.R#L133   ## function does not fail (It need to  ...
R/gamlss_fix.R#L134   if (sys.call(position)[1]=="predict.ga ...
R/gamlss_fix.R#L136   } else if (sys.call(position)[1]=="gam ...
R/gamlss_fix.R#L138       Data <- stats::model.frame(formula ...
R/gamlss_fix.R#L140       Data <- get("gamlsscall", envir=ga ...
R/gamlss_fix.R#L142   } else { ...
R/gamlss_fix.R#L144   } ...
R/gamlss_fix.R#L145   Data <- data.frame(eval(substitute(Dat ...
R/gamlss_fix.R#L146   #------------------------------------- ...
R/gamlss_fix.R#L147   # new Daniil and Vlasis ...
R/gamlss_fix.R#L148   # Initialize bam ...
R/gamlss_fix.R#L149   formula <- stats::as.formula(paste0("Y ...
R/gamlss_fix.R#L150   Data$Y.var = rep(0, nrow(Data)) ...
R/gamlss_fix.R#L151   #browser() ...
R/gamlss_fix.R#L152   G = mgcv::bam(formula, ...
R/gamlss_fix.R#L178   ) ...
R/gamlss_fix.R#L179   ##bam(formula, family=gaussian(), ...
R/gamlss_fix.R#L180   ##      data=list()#, weights=NULL, su ...
R/gamlss_fix.R#L181   #    na.action=na.omit, offset=NULL#,  ...
R/gamlss_fix.R#L182   #    select=FALSE#, scale=0#,gamma=1,k ...
R/gamlss_fix.R#L183   #    paraPen=NULL,chunk.size=10000,rho ...
R/gamlss_fix.R#L184   #    cluster=NULL,nthreads=1,gc.level= ...
R/gamlss_fix.R#L185   #    coef=NULL,drop.unused.levels=TRUE ...
R/gamlss_fix.R#L186   # ...
R/gamlss_fix.R#L187   #------------------------------------- ...
R/gamlss_fix.R#L188   xvar <- rep(0,  dim(Data)[1]) ...
R/gamlss_fix.R#L189   attr(xvar,"formula")     <- formula ...
R/gamlss_fix.R#L190   attr(xvar,"control")     <- control ...
R/gamlss_fix.R#L191   attr(xvar, "gamlss.env") <- gamlss.env ...
R/gamlss_fix.R#L192   attr(xvar, "data")       <- as.data.fr ...
R/gamlss_fix.R#L193   attr(xvar, "call")       <- substitute ...
R/gamlss_fix.R#L194   attr(xvar, "class")      <- "smooth" ...
R/gamlss_fix.R#L195   attr(xvar, "G")          <- G ...
R/gamlss_fix.R#L196   xvar ...
R/gamlss_fix.R#L231                        method = "fREML", ...
R/gamlss_fix.R#L232                        control = list(), ...
R/gamlss_fix.R#L233                        select = FALSE, ...
R/gamlss_fix.R#L234                        scale = 0, ...
R/gamlss_fix.R#L235                        gamma = 1, ...
R/gamlss_fix.R#L236                        knots = NULL, ...
R/gamlss_fix.R#L237                        sp = NULL, ...
R/gamlss_fix.R#L238                        min.sp = NULL, ...
R/gamlss_fix.R#L239                        paraPen = NULL, ...
R/gamlss_fix.R#L240                        chunk.size = 1000 ...
R/gamlss_fix.R#L241                        rho = 0, ...
R/gamlss_fix.R#L242                        AR.start = NULL, ...
R/gamlss_fix.R#L243                        discrete = TRUE, ...
R/gamlss_fix.R#L244                        cluster = NULL, ...
R/gamlss_fix.R#L245                        nthreads = 2, ...
R/gamlss_fix.R#L246                        gc.level = 1, ...
R/gamlss_fix.R#L247                        use.chol = FALSE, ...
R/gamlss_fix.R#L248                        samfrac = 1, ...
R/gamlss_fix.R#L249                        coef = NULL, ...
R/gamlss_fix.R#L250                        drop.unused.level ...
R/gamlss_fix.R#L251                        drop.intercept =  ...
R/gamlss_fix.R#L252                        ...) ...
R/gamlss_fix.R#L254   #gam() ...
R/gamlss_fix.R#L255   control <- mgcv::gam.control(...) ...
R/gamlss_fix.R#L256   #ga() ...
R/gamlss_fix.R#L257   list( offset=offset, method=method, co ...
R/gamlss_fix.R#L293                        method = "REML", ...
R/gamlss_fix.R#L294                        optimizer = c("ou ...
R/gamlss_fix.R#L295                        control = list(), ...
R/gamlss_fix.R#L296                        scale = 0, ...
R/gamlss_fix.R#L297                        select = FALSE, ...
R/gamlss_fix.R#L298                        knots = NULL, ...
R/gamlss_fix.R#L299                        sp = NULL, ...
R/gamlss_fix.R#L300                        min.sp = NULL, ...
R/gamlss_fix.R#L301                        H = NULL, ...
R/gamlss_fix.R#L302                        gamma = 1, ...
R/gamlss_fix.R#L303                        paraPen = NULL, ...
R/gamlss_fix.R#L304                        in.out = NULL, ...
R/gamlss_fix.R#L305                        drop.unused.level ...
R/gamlss_fix.R#L306                        drop.intercept =  ...
R/gamlss_fix.R#L307                        discrete = FALSE, ...
R/gamlss_fix.R#L308                        ...) ...
R/gamlss_fix.R#L310   #gam() ...
R/gamlss_fix.R#L311   control <- mgcv::gam.control(...) ...
R/gamlss_fix.R#L312   #ga() ...
R/gamlss_fix.R#L313   list(offset=offset, method=method, opt ...
R/gamlss_fix.R#L314        scale= scale, ...
R/gamlss_fix.R#L315        select=select, knots=knots, sp=sp ...
R/gamlss_fix.R#L316        paraPen=paraPen, in.out=in.out,   ...
R/gamlss_fix.R#L317        drop.intercept=drop.intercept, di ...
R/gamlss_fix.R#L337   object <- formula ...
R/gamlss_fix.R#L338   dots <- list(...) ...
R/gamlss_fix.R#L339   what <- if (!is.null(parameter)) { ...
R/gamlss_fix.R#L341   } else match.arg(what) ...
R/gamlss_fix.R#L342   Call <- object$call ...
R/gamlss_fix.R#L343   parform <- stats::formula(object, what ...
R/gamlss_fix.R#L344   data <- if (!is.null(Call$data)) { ...
R/gamlss_fix.R#L349       eval(Call$data, environment(formul ...
R/gamlss_fix.R#L352       eval(Call$data, environment(formul ...
R/gamlss_fix.R#L354       eval(Call$data, environment(formul ...
R/gamlss_fix.R#L356       eval(Call$data, environment(formul ...
R/gamlss_fix.R#L359   } else { ...
R/gamlss_fix.R#L361   } ...
R/gamlss_fix.R#L362   Terms <- stats::terms(parform) ...
R/gamlss_fix.R#L363   mf <- stats::model.frame( ...
R/gamlss_fix.R#L367   ) ...
R/gamlss_fix.R#L368   mf ...
R/gamlss_fix.R#L384   if (is.null(xeval)) ...
R/gamlss_fix.R#L385   {#fitting ...
R/gamlss_fix.R#L400          nl.df = df, lambda=fit$sp[1], # ...
R/gamlss_fix.R#L401          coefSmo = fit, var=NA)    # var ...
R/gamlss_fix.R#L402   } else { # predict ...
R/gamlss_fix.R#L411   } ...
R/gamlss_fix.R#L428   if (is.null(xeval)) ...
R/gamlss_fix.R#L429   {#fitting ...
R/gamlss_fix.R#L439                       offset=control$off ...
R/gamlss_fix.R#L440                       control=control$co ...
R/gamlss_fix.R#L441                       scale=control$scal ...
R/gamlss_fix.R#L442                       knots=control$knot ...
R/gamlss_fix.R#L443                       paraPen=control$pa ...
R/gamlss_fix.R#L444                       rho=control$rho, A ...
R/gamlss_fix.R#L445                       discrete=control$d ...
R/gamlss_fix.R#L446                       cluster=control$cl ...
R/gamlss_fix.R#L447                       gc.level=control$g ...
R/gamlss_fix.R#L448                       samfrac=control$sa ...
R/gamlss_fix.R#L449                       drop.unused.levels ...
R/gamlss_fix.R#L454           nl.df = df, lambda=fit$sp[1],  ...
R/gamlss_fix.R#L455           coefSmo = fit, var=NA)    # va ...
R/gamlss_fix.R#L456   } else { # predict ...
R/gamlss_fix.R#L465   } ...
R/gamlss_fix.R#L471                            what = c("mu" ...
R/gamlss_fix.R#L472                            parameter = N ...
R/gamlss_fix.R#L473                            newdata = NUL ...
R/gamlss_fix.R#L474                            type = c("lin ...
R/gamlss_fix.R#L475                            terms = NULL, ...
R/gamlss_fix.R#L476                            se.fit = FALS ...
R/gamlss_fix.R#L477                            data = NULL,  ...
R/gamlss_fix.R#L479   ## this little function put data frame ...
R/gamlss_fix.R#L480   ##  originated from an the R-help repl ...
R/gamlss_fix.R#L481   ##------------------------------------ ...
R/gamlss_fix.R#L482   ##------------------------------------ ...
R/gamlss_fix.R#L483   ##-------- concat starts here ...
R/gamlss_fix.R#L484   concat <- function(..., names=NULL) ...
R/gamlss_fix.R#L485   { ...
R/gamlss_fix.R#L490       sapply(tmp, is.matrix) ...
R/gamlss_fix.R#L491       | ...
R/gamlss_fix.R#L492       sapply(tmp, is.data.frame) ) ) ...
R/gamlss_fix.R#L494       len <- sapply(tmp, function(x) c(d ...
R/gamlss_fix.R#L495       len[is.null(len)] <- 1 ...
R/gamlss_fix.R#L496       data <- rbind( ... ) ...
R/gamlss_fix.R#L500       len <- sapply(tmp,length) ...
R/gamlss_fix.R#L501       data <- unlist(tmp) ...
R/gamlss_fix.R#L505   } ...
R/gamlss_fix.R#L506   ##----------concat finish here ...
R/gamlss_fix.R#L507   ##------------------------------------ ...
R/gamlss_fix.R#L508   ##------------------------------------ ...
R/gamlss_fix.R#L509   ##   main function starts here ...
R/gamlss_fix.R#L510   ##---------------------------- ...
R/gamlss_fix.R#L511   ## If no new data just use lpred() and ...
R/gamlss_fix.R#L512   if (is.null(newdata))  # ...
R/gamlss_fix.R#L513   { ...
R/gamlss_fix.R#L518   } ...
R/gamlss_fix.R#L519   ## at the moment se.fit is not support ...
R/gamlss_fix.R#L520   if (se.fit) ...
R/gamlss_fix.R#L522   ##  stop if newdata is not data frame ...
R/gamlss_fix.R#L523   ## note that atomic is not working her ...
R/gamlss_fix.R#L524   ## if (!(is.atomic(newdata) | inherits ...
R/gamlss_fix.R#L525   #if (!(inherits(newdata, "data.frame") ...
R/gamlss_fix.R#L526    # stop("newdata must be a data frame  ...
R/gamlss_fix.R#L527   ## getting which parameter and type ...
R/gamlss_fix.R#L528   what <- if (!is.null(parameter))  { ...
R/gamlss_fix.R#L530   type <- match.arg(type) ...
R/gamlss_fix.R#L531   ## get the original call ...
R/gamlss_fix.R#L532   Call <- object$call ...
R/gamlss_fix.R#L533   ## we need both the old and the new da ...
R/gamlss_fix.R#L534   ## the argument data can be provided b ...
R/gamlss_fix.R#L535   data<-if (is.null(data)) ...
R/gamlss_fix.R#L536   {        ## if it is not provided then ...
R/gamlss_fix.R#L539   }else{ ...
R/gamlss_fix.R#L541   } ...
R/gamlss_fix.R#L542   # else data # if it provide get it ...
R/gamlss_fix.R#L543   ## keep only the same variables ...
R/gamlss_fix.R#L544   ## this assumes that all the relevant  ...
R/gamlss_fix.R#L545   ## what happens if not? ...
R/gamlss_fix.R#L546   data <- data[,match(names(newdata),nam ...
R/gamlss_fix.R#L547   ## merge the two data together ...
R/gamlss_fix.R#L548   data <- concat(data,newdata) ...
R/gamlss_fix.R#L549   ## get the formula ...
R/gamlss_fix.R#L550   parform <- stats::formula(object, what ...
R/gamlss_fix.R#L551   ## put response to NULL ...
R/gamlss_fix.R#L552   if (length(parform)==3) ...
R/gamlss_fix.R#L554   ## define the terms ...
R/gamlss_fix.R#L555   Terms <- terms(parform) ...
R/gamlss_fix.R#L556   ## get the offset ...
R/gamlss_fix.R#L557   offsetVar <- if (!is.null(off.num <- a ...
R/gamlss_fix.R#L559   ## model frame ...
R/gamlss_fix.R#L560   if(is.null(environment(Terms))){ ...
R/gamlss_fix.R#L562   } ...
R/gamlss_fix.R#L563   m <- stats::model.frame(Terms, data, x ...
R/gamlss_fix.R#L564   ## model design matrix y and w ...
R/gamlss_fix.R#L565   X <- stats::model.matrix(Terms, data,  ...
R/gamlss_fix.R#L566   y <- object[[paste(what,"lp",sep=".")] ...
R/gamlss_fix.R#L567   w <- object[[paste(what,"wt",sep=".")] ...
R/gamlss_fix.R#L568   ## leave for future checks ...
R/gamlss_fix.R#L569   #  aN <- dim(newdata)[1] ...
R/gamlss_fix.R#L570   #zeros <- rep(0,aN) ...
R/gamlss_fix.R#L571   #ones <- rep(1,aN) ...
R/gamlss_fix.R#L572   #yaug <- as.vector(c(y,zeros)) ...
R/gamlss_fix.R#L573   #waug <- as.vector(c(w,zeros)) ...
R/gamlss_fix.R#L574   ## for keeping only the original data ...
R/gamlss_fix.R#L575   onlydata <- data$source == "data" # TR ...
R/gamlss_fix.R#L576   ## whether additive terms are involved ...
R/gamlss_fix.R#L577   smo.mat <- object[[paste(what,"s",sep= ...
R/gamlss_fix.R#L578   ## if offset take it out from fitting ...
R/gamlss_fix.R#L579   if (!is.null(off.num)) ...
R/gamlss_fix.R#L581   ## if smoothing ...
R/gamlss_fix.R#L582   if (!is.null(smo.mat)) ...
R/gamlss_fix.R#L583   { ...
R/gamlss_fix.R#L586   } ...
R/gamlss_fix.R#L587   ## refit the model ...
R/gamlss_fix.R#L588   # refit <- lm.wfit(X[onlydata,  , drop ...
R/gamlss_fix.R#L589   # ## ckeck the residuals if they are z ...
R/gamlss_fix.R#L590   # ##if (any(abs(resid(refit))>1e-005)) ...
R/gamlss_fix.R#L591   # if (abs(sum(resid(refit)))>1e-001||a ...
R/gamlss_fix.R#L592   #   warning(paste("There is a discrepa ...
R/gamlss_fix.R#L593   #                 " \n used to achieve ...
R/gamlss_fix.R#L594   ## this is disturbing fit and refit ha ...
R/gamlss_fix.R#L595   ## fit <- lm.wfit(X, yaug, waug) ...
R/gamlss_fix.R#L596   ## get the coefficients ...
R/gamlss_fix.R#L597   coef <- coef(object, what=what)        ...
R/gamlss_fix.R#L598   nX <- dimnames(X)        ## the names  ...
R/gamlss_fix.R#L599   rownames <- nX[[1]][!onlydata] ## only ...
R/gamlss_fix.R#L600   nrows <- sum(!onlydata)     ## the num ...
R/gamlss_fix.R#L601   nac <- is.na(coef)        ## whether t ...
R/gamlss_fix.R#L602   assign.coef <- attr(X, "assign")  ## X ...
R/gamlss_fix.R#L603   collapse <- type != "terms"## !collaps ...
R/gamlss_fix.R#L604   Xpred <- X[!onlydata,] ...
R/gamlss_fix.R#L605   Xpred <- matrix(Xpred, nrow=nrows) # I ...
R/gamlss_fix.R#L606   # I will check this later ...
R/gamlss_fix.R#L607   if (!collapse)       ## whether type== ...
R/gamlss_fix.R#L608   { ...
R/gamlss_fix.R#L621       asgn$"(Intercept)" <- NULL ...
R/gamlss_fix.R#L622       avx <- colMeans(X[onlydata, ]) ...
R/gamlss_fix.R#L623       termsconst <- sum(avx[piv] * coef[ ...
R/gamlss_fix.R#L639       Xpred <- sweep(Xpred, 2, avx) ...
R/gamlss_fix.R#L644       iipiv <- asgn[[i]] ...
R/gamlss_fix.R#L645       ii <- unpiv[iipiv] ...
R/gamlss_fix.R#L646       iipiv[ii == 0] <- 0 ...
R/gamlss_fix.R#L647       pred[, i] <- if (any(iipiv > 0)) # ...
R/gamlss_fix.R#L649       else 0 ...
R/gamlss_fix.R#L650       #              if (se.fit ) ...
R/gamlss_fix.R#L651       #                ip[, i] <- if (an ...
R/gamlss_fix.R#L652       #                  as.matrix(X[, i ...
R/gamlss_fix.R#L653       #                    , drop = FALS ...
R/gamlss_fix.R#L654       #                else 0 ...
R/gamlss_fix.R#L661       pred <- pred[, terms, drop = FALSE ...
R/gamlss_fix.R#L662       #   if (se.fit) ...
R/gamlss_fix.R#L663       #     ip <- ip[, terms, drop = FAL ...
R/gamlss_fix.R#L665   } ## end if for terms ...
R/gamlss_fix.R#L666   else  ## if type is not terms but "lin ...
R/gamlss_fix.R#L667   { ...
R/gamlss_fix.R#L670       pred <- pred + offsetVar[!onlydata ...
R/gamlss_fix.R#L671   } ...
R/gamlss_fix.R#L672   ## ...
R/gamlss_fix.R#L673   ## now the smoothing part ...
R/gamlss_fix.R#L674   ## ...
R/gamlss_fix.R#L675   if (!is.null(smo.mat)) ...
R/gamlss_fix.R#L676   { ...
R/gamlss_fix.R#L680                                          ...
R/gamlss_fix.R#L694       if (is.matrix(m[[TT]])) # the prob ...
R/gamlss_fix.R#L695       { # MS 27-6-11         # in this c ...
R/gamlss_fix.R#L698       }                                  ...
R/gamlss_fix.R#L699       else   attributes(data[[TT]]) <- a ...
R/gamlss_fix.R#L700       Call <- smooth.calls[[TT]] # ...
R/gamlss_fix.R#L701       Call$xeval <- substitute(new.m[[TT ...
R/gamlss_fix.R#L702       z <- residuals + smo.mat[, TT] ...
R/gamlss_fix.R#L703       # debug(gamlss.pvc) ...
R/gamlss_fix.R#L704       pred.s[, TT] <- eval(Call) ...
R/gamlss_fix.R#L708       # pred[, smooth.wanted] <- pred[,  ...
R/gamlss_fix.R#L709       pred[, smooth.labels] <- pred[, sm ...
R/gamlss_fix.R#L712   } ...
R/gamlss_fix.R#L713   if(type == "response") ...
R/gamlss_fix.R#L714   { ...
R/gamlss_fix.R#L718       FAM <- stats::family(object)[1] ...
R/gamlss_fix.R#L724   } ...
R/gamlss_fix.R#L725   names(pred) <- rownames(newdata) ...
R/gamlss_fix.R#L726   pred ...
R/perform_lrt.R#L60   p_tab <- mapply(function(fit1, fit2) { ...
R/perform_lrt.R#L70       stop("Could not extract dependent  ...
R/perform_lrt.R#L73       stop(paste("Models appear to have  ...
R/perform_lrt.R#L74                  "Model 1 has ",m1n," ob ...
R/perform_lrt.R#L75                  "Model 2 has ",m2n," ob ...
R/perform_lrt.R#L76                  sep="") ...
R/perform_lrt.R#L77       ) ...
R/perform_lrt.R#L80       stop(paste("Models appear to have  ...
R/perform_lrt.R#L85       k1 <- fit1$df.fit ...
R/perform_lrt.R#L88       k1 <- sum(fit1$edf2 + fit1$edf1 -  ...
R/perform_lrt.R#L90       stop("Model must be either gamlss  ...
R/perform_lrt.R#L94       k2 <- fit2$df.fit ...
R/perform_lrt.R#L97       k2 <- sum(fit2$edf2 + fit2$edf1 -  ...
R/perform_lrt.R#L99       stop("Model must be either gamlss  ...
R/perform_lrt.R#L119   }, fit1 = alter_marginal, fit2 = null_ ...
R/perform_lrt.R#L120   p_tab <- as.data.frame(t(p_tab)) ...
R/perform_lrt.R#L122   return(p_tab) ...
R/plot_reduceddim.R#L42   Method <- NULL ## Avoid check note. ...
R/plot_reduceddim.R#L43   stopifnot(length(name_vec) == (length( ...
R/plot_reduceddim.R#L45   mat_ref <- t(as.matrix(SummarizedExper ...
R/plot_reduceddim.R#L47   if(sum(matrixStats::colVars(mat_ref) = ...
R/plot_reduceddim.R#L49   } ...
R/plot_reduceddim.R#L51   if(!is.null(shape_by)){ ...
R/plot_reduceddim.R#L53       stop("The shape_by in not in your  ...
R/plot_reduceddim.R#L57       stop("The shape_by in not in your  ...
R/plot_reduceddim.R#L59   } ...
R/plot_reduceddim.R#L61   mat_list <- lapply(sce_list, function( ...
R/plot_reduceddim.R#L64   }) ...
R/plot_reduceddim.R#L66   ref_pca_fit <- irlba::prcomp_irlba(mat ...
R/plot_reduceddim.R#L67                                      cen ...
R/plot_reduceddim.R#L68                                      sca ...
R/plot_reduceddim.R#L69                                      n = ...
R/plot_reduceddim.R#L70   ref_pca <- ref_pca_fit$x ...
R/plot_reduceddim.R#L71   if(pc_umap) { ...
R/plot_reduceddim.R#L73   } else { ...
R/plot_reduceddim.R#L75   } ...
R/plot_reduceddim.R#L76   ref_umap <- ref_umap_fit$layout ...
R/plot_reduceddim.R#L77   colnames(ref_umap) <- c("UMAP1", "UMAP ...
R/plot_reduceddim.R#L79   SingleCellExperiment::reducedDim(ref_s ...
R/plot_reduceddim.R#L80   SingleCellExperiment::reducedDim(ref_s ...
R/plot_reduceddim.R#L82   sce_list <- lapply(sce_list, function( ...
R/plot_reduceddim.R#L86       res <- stats::predict(object = ref ...
R/plot_reduceddim.R#L88       res <- stats::predict(object = ref ...
R/plot_reduceddim.R#L90      colnames(res) <- c("UMAP1", "UMAP2" ...
R/plot_reduceddim.R#L93   }) ...
R/plot_reduceddim.R#L95   sce_list_new <- c(list(ref_sce), sce_l ...
R/plot_reduceddim.R#L96   names(sce_list_new) <- name_vec ...
R/plot_reduceddim.R#L98   rd_list <- lapply(sce_list_new, functi ...
R/plot_reduceddim.R#L101       rd <- dplyr::select(rd, color_by) ...
R/plot_reduceddim.R#L103       rd <- dplyr::select(rd, c(color_by ...
R/plot_reduceddim.R#L112   }) ...
R/plot_reduceddim.R#L114   names(rd_list) <- names(sce_list_new) ...
R/plot_reduceddim.R#L116   rd_tbl <- dplyr::bind_rows(rd_list, .i ...
R/plot_reduceddim.R#L117   rd_tbl <- dplyr::mutate(rd_tbl, Method ...
R/plot_reduceddim.R#L119   if(if_plot) { ...
R/plot_reduceddim.R#L122       geom_point(alpha = 0.5, size = poi ...
R/plot_reduceddim.R#L123       facet_wrap(~Method, nrow = 1) + ...
R/plot_reduceddim.R#L124       theme(aspect.ratio = 1, legend.pos ...
R/plot_reduceddim.R#L125        ...
R/plot_reduceddim.R#L127       geom_point(alpha = 0.5, size = poi ...
R/plot_reduceddim.R#L128       facet_wrap(~Method, nrow = 1) + ...
R/plot_reduceddim.R#L129       theme(aspect.ratio = 1, legend.pos ...
R/plot_reduceddim.R#L130        ...
R/plot_reduceddim.R#L133       p_pca <- p_pca + viridis::scale_co ...
R/plot_reduceddim.R#L134       p_umap <- p_umap + viridis::scale_ ...
R/plot_reduceddim.R#L136       p_pca <- p_pca + guides(color = gu ...
R/plot_reduceddim.R#L137       p_umap <- p_umap + guides(color =  ...
R/plot_reduceddim.R#L142   } else { ...
R/plot_reduceddim.R#L144   } ...
R/scdesign3.R#L84                       assay_use = "count ...
R/scdesign3.R#L85                       celltype, ...
R/scdesign3.R#L86                       pseudotime = NULL, ...
R/scdesign3.R#L87                       spatial = NULL, ...
R/scdesign3.R#L88                       other_covariates, ...
R/scdesign3.R#L89                       ncell = dim(sce)[2 ...
R/scdesign3.R#L90                       mu_formula, ...
R/scdesign3.R#L91                       sigma_formula = "1 ...
R/scdesign3.R#L92                       family_use = "nb", ...
R/scdesign3.R#L93                       n_cores = 2, ...
R/scdesign3.R#L94                       correlation_functi ...
R/scdesign3.R#L95                       usebam = FALSE, ...
R/scdesign3.R#L96                       edf_flexible = FAL ...
R/scdesign3.R#L97                       corr_formula, ...
R/scdesign3.R#L98                       empirical_quantile ...
R/scdesign3.R#L99                       copula = "gaussian ...
R/scdesign3.R#L100                       if_sparse = FALSE, ...
R/scdesign3.R#L101                       fastmvn = FALSE, ...
R/scdesign3.R#L102                       DT = TRUE, ...
R/scdesign3.R#L103                       pseudo_obs = FALSE ...
R/scdesign3.R#L104                       family_set = c("ga ...
R/scdesign3.R#L105                       important_feature  ...
R/scdesign3.R#L106                       nonnegative = TRUE ...
R/scdesign3.R#L107                       nonzerovar = FALSE ...
R/scdesign3.R#L108                       return_model = FAL ...
R/scdesign3.R#L109                       simplify = FALSE, ...
R/scdesign3.R#L110                       parallelization =  ...
R/scdesign3.R#L111                       n_rep = 1, ...
R/scdesign3.R#L112                       BPPARAM = NULL, ...
R/scdesign3.R#L113                       trace = FALSE) { ...
R/scdesign3.R#L114   message("Input Data Construction Start ...
R/scdesign3.R#L116   input_data <- construct_data( ...
R/scdesign3.R#L127   ) ...
R/scdesign3.R#L128   message("Input Data Construction End") ...
R/scdesign3.R#L130   message("Start Marginal Fitting") ...
R/scdesign3.R#L131   marginal_res <- fit_marginal( ...
R/scdesign3.R#L143   ) ...
R/scdesign3.R#L144   message("Marginal Fitting End") ...
R/scdesign3.R#L146   if(empirical_quantile == TRUE) { ...
R/scdesign3.R#L149       sce = sce, ...
R/scdesign3.R#L150       assay_use = assay_use, ...
R/scdesign3.R#L151       input_data = input_data$dat, ...
R/scdesign3.R#L152       marginal_list = marginal_res, ...
R/scdesign3.R#L153       family_use = family_use, ...
R/scdesign3.R#L154       empirical_quantile = TRUE, ...
R/scdesign3.R#L155       copula = copula, ...
R/scdesign3.R#L156       family_set = family_set, ...
R/scdesign3.R#L157       n_cores = n_cores, ...
R/scdesign3.R#L158       important_feature = important_feat ...
R/scdesign3.R#L159       if_sparse = if_sparse, ...
R/scdesign3.R#L160       parallelization = parallelization, ...
R/scdesign3.R#L161       BPPARAM = BPPARAM ...
R/scdesign3.R#L163   } else { ...
R/scdesign3.R#L166       sce = sce, ...
R/scdesign3.R#L167       assay_use = assay_use, ...
R/scdesign3.R#L168       input_data = input_data$dat, ...
R/scdesign3.R#L169       marginal_list = marginal_res, ...
R/scdesign3.R#L170       family_use = family_use, ...
R/scdesign3.R#L171       copula = copula, ...
R/scdesign3.R#L172       family_set = family_set, ...
R/scdesign3.R#L173       n_cores = n_cores, ...
R/scdesign3.R#L174       correlation_function = correlation ...
R/scdesign3.R#L175       important_feature = important_feat ...
R/scdesign3.R#L176       if_sparse = if_sparse, ...
R/scdesign3.R#L177       parallelization = parallelization, ...
R/scdesign3.R#L178       BPPARAM = BPPARAM ...
R/scdesign3.R#L181   } ...
R/scdesign3.R#L182    ...
R/scdesign3.R#L183    ...
R/scdesign3.R#L185   message("Start Parameter Extraction") ...
R/scdesign3.R#L186   para_list <- extract_para( ...
R/scdesign3.R#L196   ) ...
R/scdesign3.R#L197   message("Parameter ...
R/scdesign3.R#L200   message("Start Generate New Data") ...
R/scdesign3.R#L201    ...
R/scdesign3.R#L202   if(empirical_quantile == TRUE) { ...
R/scdesign3.R#L204       sce = sce, ...
R/scdesign3.R#L205       assay_use= assay_use, ...
R/scdesign3.R#L206       mean_mat = para_list$mean_mat, ...
R/scdesign3.R#L207       sigma_mat = para_list$sigma_mat, ...
R/scdesign3.R#L208       zero_mat = para_list$zero_mat, ...
R/scdesign3.R#L209       quantile_mat = copula_res$quantile ...
R/scdesign3.R#L210       copula_list = NULL, ...
R/scdesign3.R#L211       n_cores = n_cores, ...
R/scdesign3.R#L212       family_use = family_use, ...
R/scdesign3.R#L213       nonnegative = nonnegative, ...
R/scdesign3.R#L214       nonzerovar = nonzerovar, ...
R/scdesign3.R#L215       input_data = input_data$dat, ...
R/scdesign3.R#L216       new_covariate = input_data$newCova ...
R/scdesign3.R#L217       important_feature = copula_res$imp ...
R/scdesign3.R#L218       parallelization = parallelization, ...
R/scdesign3.R#L219       BPPARAM = BPPARAM, ...
R/scdesign3.R#L220       filtered_gene = input_data$filtere ...
R/scdesign3.R#L222   } else { ...
R/scdesign3.R#L224       new_count <- simu_new( ...
R/scdesign3.R#L242       ) ...
R/scdesign3.R#L244       new_count <- lapply(seq_len(n_rep) ...
R/scdesign3.R#L246           sce = sce, ...
R/scdesign3.R#L247           assay_use= assay_use, ...
R/scdesign3.R#L248           mean_mat = para_list$mean_mat, ...
R/scdesign3.R#L249           sigma_mat = para_list$sigma_ma ...
R/scdesign3.R#L250           zero_mat = para_list$zero_mat, ...
R/scdesign3.R#L251           quantile_mat = NULL, ...
R/scdesign3.R#L252           copula_list = copula_res$copul ...
R/scdesign3.R#L253           n_cores = n_cores, ...
R/scdesign3.R#L254           family_use = family_use, ...
R/scdesign3.R#L255           nonnegative = nonnegative, ...
R/scdesign3.R#L256           nonzerovar = nonzerovar, ...
R/scdesign3.R#L257           input_data = input_data$dat, ...
R/scdesign3.R#L258           new_covariate = input_data$new ...
R/scdesign3.R#L259           important_feature = copula_res ...
R/scdesign3.R#L260           parallelization = parallelizat ...
R/scdesign3.R#L261           BPPARAM = BPPARAM, ...
R/scdesign3.R#L262           filtered_gene = input_data$fil ...
R/scdesign3.R#L265       }) ...
R/scdesign3.R#L267   } ...
R/scdesign3.R#L268    ...
R/scdesign3.R#L269   message("New Data Generating End") ...
R/scdesign3.R#L271   scdesign3_res <- list( ...
R/scdesign3.R#L277       marginal_res ...
R/scdesign3.R#L279       NULL, ...
R/scdesign3.R#L281       copula_res$copula_list ...
R/scdesign3.R#L283       NULL ...
R/scdesign3.R#L284   ) ...
R/scdesign3.R#L285   return(scdesign3_res) ...
R/simu_new.R#L92                      assay_use = "counts ...
R/simu_new.R#L93                      mean_mat, ...
R/simu_new.R#L94                      sigma_mat, ...
R/simu_new.R#L95                      zero_mat, ...
R/simu_new.R#L96                      quantile_mat = NULL ...
R/simu_new.R#L97                      copula_list, ...
R/simu_new.R#L98                      n_cores, ...
R/simu_new.R#L99                      fastmvn = FALSE, ...
R/simu_new.R#L100                      family_use, ...
R/simu_new.R#L101                      nonnegative = TRUE, ...
R/simu_new.R#L102                      nonzerovar = FALSE, ...
R/simu_new.R#L103                      input_data, ...
R/simu_new.R#L104                      new_covariate, ...
R/simu_new.R#L105                      important_feature = ...
R/simu_new.R#L106                      parallelization = " ...
R/simu_new.R#L107                      BPPARAM = NULL, ...
R/simu_new.R#L108                      filtered_gene){ ...
R/simu_new.R#L109   if(!is.null(quantile_mat) & !is.null(c ...
R/simu_new.R#L111   } ...
R/simu_new.R#L113   # check if user inputted new covariate ...
R/simu_new.R#L114   data_temp <- input_data[,colnames(new_ ...
R/simu_new.R#L115   if(identical(data_temp, new_covariate) ...
R/simu_new.R#L117   } ...
R/simu_new.R#L118    ...
R/simu_new.R#L119   qc_gene_idx <- which(!rownames(sce) %i ...
R/simu_new.R#L120   if(length(family_use) != 1){ ...
R/simu_new.R#L122   } ...
R/simu_new.R#L123   ...
R/simu_new.R#L125       message("Multivariate quantile mat ...
R/simu_new.R#L126        ...
R/simu_new.R#L127       newmvn_full <- matrix(NA, nrow = d ...
R/simu_new.R#L128       rownames(newmvn_full) <- rownames( ...
R/simu_new.R#L129       colnames(newmvn_full) <- rownames( ...
R/simu_new.R#L130       newmvn_full[rownames(quantile_mat) ...
R/simu_new.R#L131       quantile_mat <- as.matrix(newmvn_f ...
R/simu_new.R#L132        ...
R/simu_new.R#L133        ...
R/simu_new.R#L135       message("Use Copula to sample a mu ...
R/simu_new.R#L136        ...
R/simu_new.R#L137       group_index <- unique(input_data$c ...
R/simu_new.R#L138       corr_group <- as.data.frame(input_ ...
R/simu_new.R#L139       colnames(corr_group) <- "corr_grou ...
R/simu_new.R#L140       ngene <- length(qc_gene_idx) ...
R/simu_new.R#L141       if (is.null(new_covariate)) { ...
R/simu_new.R#L143       } else{ ...
R/simu_new.R#L146       } ...
R/simu_new.R#L147       ind <- group_index[1] == "ind" ...
R/simu_new.R#L148       newmvn.list <- ...
R/simu_new.R#L150                                      sce ...
R/simu_new.R#L151                                      cor ...
R/simu_new.R#L152                                      new ...
R/simu_new.R#L153                                      ind ...
R/simu_new.R#L154                                      n_c ...
R/simu_new.R#L155                                      cop ...
R/simu_new.R#L156           message(paste0("Sample Copula  ...
R/simu_new.R#L157           curr_index <- which(corr_group ...
R/simu_new.R#L158           if (is.null(new_covariate)) { ...
R/simu_new.R#L161           } else{ ...
R/simu_new.R#L165           } ...
R/simu_new.R#L166           cor.mat <- copula_list[[x]] ...
R/simu_new.R#L167            ...
R/simu_new.R#L168           if(curr_ncell == 0) { ...
R/simu_new.R#L170           } else { ...
R/simu_new.R#L172               #message(paste0("Group ",  ...
R/simu_new.R#L173                ...
R/simu_new.R#L174               #message("Sample MVN") ...
R/simu_new.R#L175               #sample from mvn for impor ...
R/simu_new.R#L176               corr_gene_idx <- apply(cor ...
R/simu_new.R#L177               corr_gene <- colnames(cor. ...
R/simu_new.R#L178               if(length(corr_gene)!=0) { ...
R/simu_new.R#L180                                          ...
R/simu_new.R#L181                                          ...
R/simu_new.R#L182                                          ...
R/simu_new.R#L183                ...
R/simu_new.R#L184               colnames(new_mvn_important ...
R/simu_new.R#L186               } ...
R/simu_new.R#L187               #message("MVN Sampling End ...
R/simu_new.R#L188               ind_gene <- colnames(cor.m ...
R/simu_new.R#L189               if(length(ind_gene) > 0){ ...
R/simu_new.R#L197               }else{ ...
R/simu_new.R#L199               } ...
R/simu_new.R#L201               rownames(new_mvu) <- curr_ ...
R/simu_new.R#L203               new_mvu <- matrix(0, nrow  ...
R/simu_new.R#L204               #message("Sampling Vine Co ...
R/simu_new.R#L205               mvu <- rvinecopulib::rvine ...
R/simu_new.R#L210               ) ...
R/simu_new.R#L211               new_mvu[, which(important_ ...
R/simu_new.R#L212               if(length(which(important_ ...
R/simu_new.R#L215                                   Sigma  ...
R/simu_new.R#L216                                   n_core ...
R/simu_new.R#L217                                   fastmv ...
R/simu_new.R#L219               } ...
R/simu_new.R#L220               #message("Sampling Vine Co ...
R/simu_new.R#L221               rownames(new_mvu) <- curr_ ...
R/simu_new.R#L223               "Use independent copula (r ...
R/simu_new.R#L224               new_mvu <- ...
R/simu_new.R#L226                        nrow = curr_ncell ...
R/simu_new.R#L227               rownames(new_mvu) <- curr_ ...
R/simu_new.R#L229               stop("Copula must be one f ...
R/simu_new.R#L231           } ...
R/simu_new.R#L232           return( ...
R/simu_new.R#L234               new_mvu = new_mvu ...
R/simu_new.R#L236           ) ...
R/simu_new.R#L238        ...
R/simu_new.R#L239       newmvn <- ...
R/simu_new.R#L241           x$new_mvu)) ...
R/simu_new.R#L242       newmvn[as.numeric(rownames(newmvn) ...
R/simu_new.R#L243       rownames(newmvn) <- as.character(1 ...
R/simu_new.R#L244       colnames(newmvn) <- rownames(sce)[ ...
R/simu_new.R#L245       newmvn_full <- matrix(NA, nrow = d ...
R/simu_new.R#L246       rownames(newmvn_full) <- rownames( ...
R/simu_new.R#L247       colnames(newmvn_full) <- rownames( ...
R/simu_new.R#L248       newmvn_full[rownames(newmvn), coln ...
R/simu_new.R#L249       quantile_mat <- as.matrix(newmvn_f ...
R/simu_new.R#L253        ...
R/simu_new.R#L254       idx <- which(mean_mat[,x] !=0) ...
R/simu_new.R#L255       para_mat <- cbind(mean_mat[idx, x] ...
R/simu_new.R#L256        ...
R/simu_new.R#L257       if (y == "binomial") { ...
R/simu_new.R#L259       } else if (y == "poisson") { ...
R/simu_new.R#L262       } else if (y == "gaussian") { ...
R/simu_new.R#L264           gamlss.dist::qNO(p = para_mat[ ...
R/simu_new.R#L265                            mu = para_mat ...
R/simu_new.R#L266                            sigma = abs(p ...
R/simu_new.R#L267       } else if (y == "nb") { ...
R/simu_new.R#L269           gamlss.dist::qNBI(p = para_mat ...
R/simu_new.R#L272       } else if (y == "zip") { ...
R/simu_new.R#L274           gamlss.dist::qZIP(p = para_mat ...
R/simu_new.R#L277       } else if (y == "zinb") { ...
R/simu_new.R#L280           gamlss.dist::qZINBI(p = para_m ...
R/simu_new.R#L281                               mu = para_ ...
R/simu_new.R#L282                               sigma = pa ...
R/simu_new.R#L283                               nu = ifels ...
R/simu_new.R#L284       } else { ...
R/simu_new.R#L286       } ...
R/simu_new.R#L287        ...
R/simu_new.R#L288       #message(paste0("Gene ", x , " End ...
R/simu_new.R#L289        ...
R/simu_new.R#L290       r <- as.vector(qfvec) ...
R/simu_new.R#L291       if(length(r) < total_cells){ ...
R/simu_new.R#L296       } ...
R/simu_new.R#L297       r ...
R/simu_new.R#L300    ...
R/simu_new.R#L303   ## New count ...
R/simu_new.R#L304   paraFunc <- parallel::mcmapply ...
R/simu_new.R#L305   if(.Platform$OS.type == "windows"){ ...
R/simu_new.R#L308   } ...
R/simu_new.R#L309   if(parallelization == "bpmapply"){ ...
R/simu_new.R#L311   } ...
R/simu_new.R#L312   if(parallelization == "pbmcmapply"){ ...
R/simu_new.R#L314   } ...
R/simu_new.R#L316   if(is.null(new_covariate)){ ...
R/simu_new.R#L319   }else{ ...
R/simu_new.R#L322   } ...
R/simu_new.R#L323   if(parallelization == "bpmapply"){ ...
R/simu_new.R#L326       BPPARAM$workers <- n_cores ...
R/simu_new.R#L329   }else{ ...
R/simu_new.R#L331                   , mc.cores = n_cores ...
R/simu_new.R#L332                    ) ...
R/simu_new.R#L333  } ...
R/simu_new.R#L334   new_count <- mat #simplify2array(mat) ...
R/simu_new.R#L335   rownames(new_count) <- cell_names ...
R/simu_new.R#L336   colnames(new_count) <- rownames(sce)[q ...
R/simu_new.R#L338   if(length(qc_gene_idx) < dim(sce)[1]){ ...
R/simu_new.R#L344   } ...
R/simu_new.R#L345   new_count <- as.matrix(t(new_count)) ...
R/simu_new.R#L347   if(nonnegative) new_count[new_count <  ...
R/simu_new.R#L349   if(nonzerovar) { ...
R/simu_new.R#L352       message("Some genes have zero vari ...
R/simu_new.R#L353       row_vars_index <- which(row_vars = ...
R/simu_new.R#L354       col_index <- seq_len(dim(new_count ...
R/simu_new.R#L355       for(i in row_vars_index) { ...
R/simu_new.R#L357       } ...
R/simu_new.R#L359   } ...
R/simu_new.R#L360   new_count <- as.matrix(new_count) ...
R/simu_new.R#L361   if(methods::is(SummarizedExperiment::a ...
R/simu_new.R#L363   } ...
R/simu_new.R#L365   return(new_count) ...
R/sparse_cov.R#L18                        method=c('cv', 'q ...
R/sparse_cov.R#L19                        operator=c('hard' ...
R/sparse_cov.R#L20                        corr=TRUE){ ...
R/sparse_cov.R#L21   p <- dim(data)[2] ...
R/sparse_cov.R#L22   n <- dim(data)[1] ...
R/sparse_cov.R#L23    ...
R/sparse_cov.R#L24   # sample covariance ...
R/sparse_cov.R#L25   z <- covariance(data) ...
R/sparse_cov.R#L26    ...
R/sparse_cov.R#L27   # select the optimal thresholding leve ...
R/sparse_cov.R#L28   delta <- est_delta(data, method=method ...
R/sparse_cov.R#L29   s <- thresh_op(z, operator=operator, d ...
R/sparse_cov.R#L30    ...
R/sparse_cov.R#L31   # Modify s to make it psd ...
R/sparse_cov.R#L32   tol <- 1e-6 ...
R/sparse_cov.R#L33   ev <- eigen(s, symmetric=TRUE, only.va ...
R/sparse_cov.R#L34   s1 <- s + (tol-min(ev))*diag(dim(s)[1] ...
R/sparse_cov.R#L35    ...
R/sparse_cov.R#L36   if(corr){ ...
R/sparse_cov.R#L40   }else{ ...
R/sparse_cov.R#L42   } ...
R/sparse_cov.R#L43    ...
R/sparse_cov.R#L44   return(output) ...
R/sparse_cov.R#L53   if(operator == 'hard'){ ...
R/sparse_cov.R#L55   }else if(operator == 'soft'){ ...
R/sparse_cov.R#L57   }else if(operator == 'scad'){ ...
R/sparse_cov.R#L59   }else if(operator == 'al'){ ...
R/sparse_cov.R#L61   }else{ ...
R/sparse_cov.R#L63   } ...
R/sparse_cov.R#L64   s_method(z, delta, n) ...
R/sparse_cov.R#L69   p<-dim(z)[1] ...
R/sparse_cov.R#L70   lambda <- sqrt(log(p)/n)*delta ...
R/sparse_cov.R#L71   output <- (z>lambda)*z ...
R/sparse_cov.R#L72   diag(output) <- diag(z) ...
R/sparse_cov.R#L73   return(output) ...
R/sparse_cov.R#L78   p <- dim(z)[1] ...
R/sparse_cov.R#L79   lambda <- sqrt(log(p)/n)*delta ...
R/sparse_cov.R#L80   z0 <- abs(z)-lambda ...
R/sparse_cov.R#L81   output <- sign(z)*(z0>0)*z0 ...
R/sparse_cov.R#L82   diag(output) <- diag(z) ...
R/sparse_cov.R#L83   return(output) ...
R/sparse_cov.R#L89   p <- dim(z)[1] ...
R/sparse_cov.R#L90   lambda <- sqrt(log(p)/n)*delta ...
R/sparse_cov.R#L91    ...
R/sparse_cov.R#L92   output <- matrix(NA, dim(z)[1], dim(z) ...
R/sparse_cov.R#L93    ...
R/sparse_cov.R#L94   index1 <- which(abs(z)<=2*lambda) ...
R/sparse_cov.R#L95   z0 <- abs(z)-lambda ...
R/sparse_cov.R#L96   output[index1] <- sign(z[index1])*(z0[ ...
R/sparse_cov.R#L97    ...
R/sparse_cov.R#L98   index2 <- which(abs(z)>2*lambda & abs( ...
R/sparse_cov.R#L99   output[index2] <- ((a-1)*z[index2]-sig ...
R/sparse_cov.R#L100    ...
R/sparse_cov.R#L101   index3 <- which(abs(z)>a*lambda) ...
R/sparse_cov.R#L102   output[index3] <- z[index3] ...
R/sparse_cov.R#L103    ...
R/sparse_cov.R#L104   diag(output) <- diag(z) ...
R/sparse_cov.R#L105   return(output) ...
R/sparse_cov.R#L111   p <- dim(z)[1] ...
R/sparse_cov.R#L112   lambda <- sqrt(log(p)/n)*delta ...
R/sparse_cov.R#L113    ...
R/sparse_cov.R#L114   eta <- 3 ...
R/sparse_cov.R#L115   z0 <- abs(z) - lambda^(eta+1)*abs(z)^( ...
R/sparse_cov.R#L116   output <- sign(z)*(z0>0)*z0 ...
R/sparse_cov.R#L117   diag(output) <- diag(z) ...
R/sparse_cov.R#L118   return(output) ...
R/sparse_cov.R#L128                       method=c('cv', 'qi ...
R/sparse_cov.R#L129                       operator=c('hard', ...
R/sparse_cov.R#L130   n <- dim(data)[1] ...
R/sparse_cov.R#L131   if((method=='qiu') ){ ...
R/sparse_cov.R#L134   }else if(method=='cv'){ ...
R/sparse_cov.R#L136   }else{ ...
R/sparse_cov.R#L138   } ...
R/sparse_cov.R#L139   return(delta) ...
R/sparse_cov.R#L145   n <- dim(data)[1] ...
R/sparse_cov.R#L146   p <- dim(data)[2] ...
R/sparse_cov.R#L147    ...
R/sparse_cov.R#L148   if(is.null(s)){ ...
R/sparse_cov.R#L150   } ...
R/sparse_cov.R#L151    ...
R/sparse_cov.R#L152   # standardized covariance of Sigma ...
R/sparse_cov.R#L153   eta <- sqrt(n/log(p))*s  ...
R/sparse_cov.R#L154   # select lower triangular ...
R/sparse_cov.R#L155   ltrig <- abs(eta[lower.tri(eta, diag = ...
R/sparse_cov.R#L156    ...
R/sparse_cov.R#L157   # parameter to select the optimal thr ...
R/sparse_cov.R#L158   a <- min(sqrt(2+log(n)/log(p)), 2) ...
R/sparse_cov.R#L159   a1 <- 2 - a ...
R/sparse_cov.R#L160   a0 <- (log(log(p)))^(-1/2) ...
R/sparse_cov.R#L161   M <- sum(((a1+a0)<ltrig) & (ltrig<=2)) ...
R/sparse_cov.R#L162   q <- (p-1)*p/2 ...
R/sparse_cov.R#L163   plog <- (log(p))^(1/2) ...
R/sparse_cov.R#L164   V <- 2*q*(stats::pnorm(2*plog)-stats:: ...
R/sparse_cov.R#L165   N2 <- max(M-V, plog) ...
R/sparse_cov.R#L166    ...
R/sparse_cov.R#L167   delta <- sqrt(2*(2-log(N2*1/plog)/log( ...
R/sparse_cov.R#L168    ...
R/sparse_cov.R#L169   return(delta) ...
R/sparse_cov.R#L183                       operator,  ...
R/sparse_cov.R#L184                       fold=5,  ...
R/sparse_cov.R#L185                       delta.length=10,  ...
R/sparse_cov.R#L186                       delta.max=2){ ...
R/sparse_cov.R#L187    ...
R/sparse_cov.R#L188   n <- dim(data)[1] ...
R/sparse_cov.R#L189   p <- dim(data)[2] ...
R/sparse_cov.R#L190    ...
R/sparse_cov.R#L191    ...
R/sparse_cov.R#L192   # Create delta list ...
R/sparse_cov.R#L193   delta.list <- seq(0, delta.max, length ...
R/sparse_cov.R#L194    ...
R/sparse_cov.R#L195   # Create equal size folds ...
R/sparse_cov.R#L196   folds <- cut(seq(1, nrow(data)), break ...
R/sparse_cov.R#L197    ...
R/sparse_cov.R#L198   fold_losses <- rep(0, fold) # Record f ...
R/sparse_cov.R#L199   cv_errors <- rep(0, delta.length) # Re ...
R/sparse_cov.R#L200    ...
R/sparse_cov.R#L201    ...
R/sparse_cov.R#L202   ## Perform k fold cross validation ...
R/sparse_cov.R#L203    ...
R/sparse_cov.R#L204   # iterate over the values of lambda ...
R/sparse_cov.R#L205   for(j in 1:delta.length){ ...
R/sparse_cov.R#L209       # Segment the data by fold  ...
R/sparse_cov.R#L210       testIndexes <- which(folds==i, arr ...
R/sparse_cov.R#L211       #trainIndexes <- which(folds!=i, a ...
R/sparse_cov.R#L212       testData <- data[testIndexes, ] ...
R/sparse_cov.R#L213       trainData <- data[-testIndexes, ] ...
R/sparse_cov.R#L214       # Get the covariance matrix estima ...
R/sparse_cov.R#L215       sample.cov.train <- covariance(tra ...
R/sparse_cov.R#L216       s <- thresh_op(sample.cov.train, o ...
R/sparse_cov.R#L217       # Compute Frobenius risk = norm(di ...
R/sparse_cov.R#L218       sample.cov.test <- covariance(test ...
R/sparse_cov.R#L219       fold_losses[i] <- norm(s - sample. ...
R/sparse_cov.R#L223   } ...
R/sparse_cov.R#L224    ...
R/sparse_cov.R#L225   # Find the lambda that minimize cv_err ...
R/sparse_cov.R#L226   delta <- delta.list[which.min(cv_error ...
R/sparse_cov.R#L227    ...
R/sparse_cov.R#L228   delta ...
R/sparse_cov.R#L234                    operator,  ...
R/sparse_cov.R#L235                    fold=5, ...
R/sparse_cov.R#L236                    delta.max=2){ ...
R/sparse_cov.R#L237   n <- dim(data)[1] ...
R/sparse_cov.R#L238   p <- dim(data)[2] ...
R/sparse_cov.R#L239    ...
R/sparse_cov.R#L240    ...
R/sparse_cov.R#L241   ## Perform k fold cross validation ...
R/sparse_cov.R#L242   cv.loss <- function(delta){ ...
R/sparse_cov.R#L249       # Segment the data by fold  ...
R/sparse_cov.R#L250       testIndexes <- which(folds==i, arr ...
R/sparse_cov.R#L251       testData <- data[testIndexes, ] ...
R/sparse_cov.R#L252       trainData <- data[-testIndexes, ] ...
R/sparse_cov.R#L253       # Get the covariance matrix estima ...
R/sparse_cov.R#L254       sample.cov.train <- covariance(tra ...
R/sparse_cov.R#L255       s <- thresh_op(sample.cov.train, o ...
R/sparse_cov.R#L256       # Compute Frobenius risk = norm(di ...
R/sparse_cov.R#L257       sample.cov.test <- covariance(test ...
R/sparse_cov.R#L258       fold_losses[i] <- norm(s - sample. ...
R/sparse_cov.R#L263   } ...
R/sparse_cov.R#L264    ...
R/sparse_cov.R#L265   # Solve the optimization problem ...
R/sparse_cov.R#L266   res <- stats::optimize(cv.loss, c(0, d ...
R/sparse_cov.R#L267   delta <- res$minimum ...
R/sparse_cov.R#L268    ...
R/sparse_cov.R#L269   delta ...
vignettes/scDesign3.Rmd#L29   white-space: pre !important; ...
vignettes/scDesign3.Rmd#L30   overflow-x: scroll !important; ...
vignettes/scDesign3.Rmd#L89   ) ...
vignettes/scDesign3.Rmd#L95   + If the parameter `ncell` is set to a ...
vignettes/scDesign3.Rmd#L96   + If the parameter `ncell` is the defa ...
vignettes/scDesign3.Rmd#L100   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L101   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L103   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L104   + If the parameter `return_model` is s ...
vignettes/scDesign3.Rmd#L121                                   sce_li ...
vignettes/scDesign3.Rmd#L122                                   name_v ...
vignettes/scDesign3.Rmd#L123                                   assay_ ...
vignettes/scDesign3.Rmd#L124                                   if_plo ...
vignettes/scDesign3.Rmd#L125                                   color_ ...
vignettes/scDesign3.Rmd#L126                                   n_pc = ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration... OK
